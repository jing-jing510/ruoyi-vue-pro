# 排班管理模块测试数据

## 🎉 开发完成状态

**排班管理模块已完成开发和优化：**
- ✅ **后端代码生成** - 主子表结构完整生成
- ✅ **前端页面优化** - ERP主子表模式，数据关联显示
- ✅ **字典数据配置** - 所有业务字典已配置完成
- ✅ **数据关联优化** - 班制-班次智能过滤，用户昵称显示
- ✅ **时间格式修复** - 解决时间序列化问题
- ✅ **表单验证优化** - 单选框、下拉框正确显示

## 📊 需要添加的字典数据

请在系统管理-字典管理中执行以下SQL：

```sql
-- 是否生产日字典
INSERT INTO `system_dict_type` (`name`, `type`, `status`, `remark`, `creator`, `create_time`, `updater`, `update_time`, `deleted`) VALUES 
('是否生产日', 'is_production_day', 0, '是否生产日', '1', NOW(), '1', NOW(), 0);

INSERT INTO `system_dict_data` (`sort`, `label`, `value`, `dict_type`, `status`, `creator`, `create_time`, `updater`, `update_time`) VALUES
(1, '否', '0', 'is_production_day', 0, '1', NOW(), '1', NOW()),
(2, '是', '1', 'is_production_day', 0, '1', NOW(), '1', NOW());

-- 是否班组长字典
INSERT INTO `system_dict_type` (`name`, `type`, `status`, `remark`, `creator`, `create_time`, `updater`, `update_time`, `deleted`) VALUES 
('是否班组长', 'is_leader', 0, '是否班组长', '1', NOW(), '1', NOW(), 0);

INSERT INTO `system_dict_data` (`sort`, `label`, `value`, `dict_type`, `status`, `creator`, `create_time`, `updater`, `update_time`) VALUES
(1, '否', '0', 'is_leader', 0, '1', NOW(), '1', NOW()),
(2, '是', '1', 'is_leader', 0, '1', NOW(), '1', NOW());
```

## 🧪 测试模拟数据

基于您系统中的真实班制和用户数据：

### 现有数据概览
**用户数据：**
- ID: 1 (admin - 芋道源码)
- ID: 100 (yudao - 芋道)  
- ID: 103 (yuanma - 源码)
- ID: 109 (admin109 - 芋艿)
- ID: 110 (admin110 - 小王)
- ID: 111 (test - 测试用户)
- ID: 112 (newobject - 新对象)

**班制数据：**
- ID: 32 (三班两倒) - 班次: 33(早班), 34(中班), 35(夜班)
- ID: 36 (四班三倒) - 班次: 37(甲班), 38(乙班), 39(丙班), 40(丁班)
- ID: 41 (两班倒) - 班次: 45(白班), 46(夜班)
- ID: 42 (长白班) - 班次: 47(白班)
- ID: 43 (检修班制) - 班次: 48(检修班)
- ID: 44 (值班班制) - 班次: 49(值班)

### 1. 主表测试数据 (coal_schedule)

```sql
-- 排班管理主表测试数据
INSERT INTO `coal_schedule` (`schedule_date`, `shift_system_id`, `schedule_status`, `is_production_day`, `production_target`, `schedule_type`, `approver_id`, `approve_time`, `remark`, `creator`, `create_time`, `updater`, `update_time`, `deleted`, `tenant_id`) VALUES
-- 2024年12月排班计划
('2024-12-09', 32, 1, 1, 1200.00, 1, 1, '2024-12-08 16:30:00', '正常生产日排班', 'admin', NOW(), 'admin', NOW(), 0, 1),
('2024-12-10', 32, 1, 1, 1150.00, 1, 1, '2024-12-09 16:30:00', '正常生产日排班', 'admin', NOW(), 'admin', NOW(), 0, 1),
('2024-12-11', 36, 1, 1, 1300.00, 1, 100, '2024-12-10 16:30:00', '四班三倒生产', 'admin', NOW(), 'admin', NOW(), 0, 1),
('2024-12-12', 32, 1, 1, 1100.00, 1, 1, '2024-12-11 16:30:00', '正常生产日排班', 'admin', NOW(), 'admin', NOW(), 0, 1),
('2024-12-13', 43, 2, 0, 0.00, 2, 1, '2024-12-12 16:30:00', '设备检修日', 'admin', NOW(), 'admin', NOW(), 0, 1),
('2024-12-14', 41, 1, 1, 1000.00, 2, 100, '2024-12-13 16:30:00', '周末生产安排', 'admin', NOW(), 'admin', NOW(), 0, 1),
('2024-12-15', 44, 3, 0, 0.00, 2, 1, '2024-12-14 16:30:00', '周日值班安排', 'admin', NOW(), 'admin', NOW(), 0, 1);
```

### 2. 子表测试数据 (coal_schedule_staff)

```sql
-- 人员安排子表测试数据

-- 12月9日 三班两倒人员安排
INSERT INTO `coal_schedule_staff` (`schedule_id`, `shift_id`, `user_id`, `position_type`, `is_leader`, `is_substitute`, `substitute_reason`, `work_status`, `contact_phone`, `emergency_contact`, `emergency_phone`, `creator`, `create_time`, `updater`, `update_time`, `deleted`, `tenant_id`) VALUES
-- 早班 (班次ID: 33)
(1, 33, 1, 1, 1, 0, NULL, 1, '13800138001', '张三妻子', '13900139001', 'admin', NOW(), 'admin', NOW(), 0, 1),
(1, 33, 100, 2, 0, 0, NULL, 1, '13800138002', '李四父亲', '13900139002', 'admin', NOW(), 'admin', NOW(), 0, 1),
(1, 33, 103, 2, 0, 0, NULL, 1, '13800138003', '王五妻子', '13900139003', 'admin', NOW(), 'admin', NOW(), 0, 1),
(1, 33, 109, 4, 0, 0, NULL, 1, '13800138004', '赵六父亲', '13900139004', 'admin', NOW(), 'admin', NOW(), 0, 1),

-- 中班 (班次ID: 34)
(1, 34, 110, 1, 1, 0, NULL, 1, '13800138005', '小王妻子', '13900139005', 'admin', NOW(), 'admin', NOW(), 0, 1),
(1, 34, 111, 2, 0, 0, NULL, 1, '13800138006', '测试用户父亲', '13900139006', 'admin', NOW(), 'admin', NOW(), 0, 1),
(1, 34, 112, 2, 0, 0, NULL, 1, '13800138007', '新对象妻子', '13900139007', 'admin', NOW(), 'admin', NOW(), 0, 1),
(1, 34, 1, 5, 0, 0, NULL, 1, '13800138008', '质检员家属', '13900139008', 'admin', NOW(), 'admin', NOW(), 0, 1),

-- 夜班 (班次ID: 35)
(1, 35, 100, 1, 1, 0, NULL, 1, '13800138009', '夜班班长家属', '13900139009', 'admin', NOW(), 'admin', NOW(), 0, 1),
(1, 35, 103, 2, 0, 0, NULL, 1, '13800138010', '夜班操作工家属', '13900139010', 'admin', NOW(), 'admin', NOW(), 0, 1),
(1, 35, 109, 3, 0, 1, '正常员工请假', 4, '13800138011', '替班人员家属', '13900139011', 'admin', NOW(), 'admin', NOW(), 0, 1);

-- 12月10日 三班两倒人员安排（部分替班）
INSERT INTO `coal_schedule_staff` (`schedule_id`, `shift_id`, `user_id`, `position_type`, `is_leader`, `is_substitute`, `substitute_reason`, `work_status`, `contact_phone`, `emergency_contact`, `emergency_phone`, `creator`, `create_time`, `updater`, `update_time`, `deleted`, `tenant_id`) VALUES
-- 早班
(2, 33, 1, 1, 1, 0, NULL, 1, '13800138001', '张三妻子', '13900139001', 'admin', NOW(), 'admin', NOW(), 0, 1),
(2, 33, 110, 2, 0, 1, '原员工生病', 4, '13800138002', '替班员工家属', '13900139002', 'admin', NOW(), 'admin', NOW(), 0, 1),
(2, 33, 103, 2, 0, 0, NULL, 1, '13800138003', '王五妻子', '13900139003', 'admin', NOW(), 'admin', NOW(), 0, 1),

-- 中班
(2, 34, 111, 1, 1, 0, NULL, 1, '13800138005', '测试班长家属', '13900139005', 'admin', NOW(), 'admin', NOW(), 0, 1),
(2, 34, 112, 2, 0, 0, NULL, 1, '13800138006', '新对象家属', '13900139006', 'admin', NOW(), 'admin', NOW(), 0, 1),
(2, 34, 100, 4, 0, 0, NULL, 1, '13800138007', '安全员家属', '13900139007', 'admin', NOW(), 'admin', NOW(), 0, 1);

-- 12月11日 四班三倒人员安排
INSERT INTO `coal_schedule_staff` (`schedule_id`, `shift_id`, `user_id`, `position_type`, `is_leader`, `is_substitute`, `substitute_reason`, `work_status`, `contact_phone`, `emergency_contact`, `emergency_phone`, `creator`, `create_time`, `updater`, `update_time`, `deleted`, `tenant_id`) VALUES
-- 甲班 (班次ID: 37)
(3, 37, 1, 1, 1, 0, NULL, 1, '13800138001', '甲班班长家属', '13900139001', 'admin', NOW(), 'admin', NOW(), 0, 1),
(3, 37, 100, 2, 0, 0, NULL, 1, '13800138002', '甲班操作工家属', '13900139002', 'admin', NOW(), 'admin', NOW(), 0, 1),
(3, 37, 103, 2, 0, 0, NULL, 1, '13800138003', '甲班操作工2家属', '13900139003', 'admin', NOW(), 'admin', NOW(), 0, 1),

-- 乙班 (班次ID: 38)
(3, 38, 109, 1, 1, 0, NULL, 1, '13800138004', '乙班班长家属', '13900139004', 'admin', NOW(), 'admin', NOW(), 0, 1),
(3, 38, 110, 2, 0, 0, NULL, 1, '13800138005', '乙班操作工家属', '13900139005', 'admin', NOW(), 'admin', NOW(), 0, 1),
(3, 38, 111, 5, 0, 0, NULL, 1, '13800138006', '乙班质检员家属', '13900139006', 'admin', NOW(), 'admin', NOW(), 0, 1),

-- 丙班 (班次ID: 39)
(3, 39, 112, 1, 1, 0, NULL, 1, '13800138007', '丙班班长家属', '13900139007', 'admin', NOW(), 'admin', NOW(), 0, 1),
(3, 39, 1, 2, 0, 0, NULL, 1, '13800138008', '丙班操作工家属', '13900139008', 'admin', NOW(), 'admin', NOW(), 0, 1);

-- 12月13日 检修日安排
INSERT INTO `coal_schedule_staff` (`schedule_id`, `shift_id`, `user_id`, `position_type`, `is_leader`, `is_substitute`, `substitute_reason`, `work_status`, `contact_phone`, `emergency_contact`, `emergency_phone`, `creator`, `create_time`, `updater`, `update_time`, `deleted`, `tenant_id`) VALUES
-- 检修班 (班次ID: 48)
(5, 48, 103, 3, 1, 0, NULL, 1, '13800138001', '检修班长家属', '13900139001', 'admin', NOW(), 'admin', NOW(), 0, 1),
(5, 48, 109, 3, 0, 0, NULL, 1, '13800138002', '检修工1家属', '13900139002', 'admin', NOW(), 'admin', NOW(), 0, 1),
(5, 48, 110, 3, 0, 0, NULL, 1, '13800138003', '检修工2家属', '13900139003', 'admin', NOW(), 'admin', NOW(), 0, 1),
(5, 48, 1, 4, 0, 0, NULL, 1, '13800138004', '安全监督员家属', '13900139004', 'admin', NOW(), 'admin', NOW(), 0, 1);

-- 12月15日 值班安排
INSERT INTO `coal_schedule_staff` (`schedule_id`, `shift_id`, `user_id`, `position_type`, `is_leader`, `is_substitute`, `substitute_reason`, `work_status`, `contact_phone`, `emergency_contact`, `emergency_phone`, `creator`, `create_time`, `updater`, `update_time`, `deleted`, `tenant_id`) VALUES
-- 值班 (班次ID: 49)
(7, 49, 111, 1, 1, 0, NULL, 1, '13800138001', '值班负责人家属', '13900139001', 'admin', NOW(), 'admin', NOW(), 0, 1),
(7, 49, 112, 4, 0, 0, NULL, 1, '13800138002', '值班安全员家属', '13900139002', 'admin', NOW(), 'admin', NOW(), 0, 1);
```

## 🎯 测试验证要点

### 主表功能测试
1. ✅ **新增排班** - 选择日期、班制、生产目标等
2. ✅ **字典显示** - 排班状态、排班类型、是否生产日正确显示
3. ✅ **关联显示** - 班制名称、审批人昵称正确显示
4. ✅ **时间格式** - 排班日期、审批时间格式正确

### 子表功能测试
1. ✅ **智能过滤** - 班次选择只显示主表选中班制下的班次
2. ✅ **人员选择** - 员工下拉框显示用户昵称
3. ✅ **字典显示** - 岗位类型、工作状态、是否班组长等正确显示
4. ✅ **替班管理** - 替班标识和原因记录功能

### 业务规则验证
1. ✅ **唯一性约束** - 每天只能有一个排班计划
2. ✅ **班组长限制** - 每个班次只能有一个班组长
3. ✅ **生产日标识** - 生产日必须设置生产目标
4. ✅ **联系方式** - 紧急联系人信息完整记录

## 📈 核心功能特色

### 智能关联
- 🎯 **班制-班次过滤** - 主表选择班制后，子表班次自动过滤
- 👤 **用户昵称显示** - 所有用户ID自动显示为用户昵称
- 📅 **时间格式完善** - 时间字段支持完整的年月日时分秒

### 业务完整性
- 📋 **多种排班类型** - 支持正常排班、节假日排班、应急排班
- 🔄 **替班流程完善** - 完善的替班流程和原因记录
- 📞 **联系方式管理** - 详细的联系方式管理
- ✅ **审批流程集成** - 灵活的审批流程集成

---

*排班管理模块开发完成* | *测试数据准备完毕* | *状态：可开始功能测试* 