# 检修管理模块设计文档

## 🎯 模块概述

检修管理模块是选煤厂设备管理的重要组成部分，实现设备检修的全流程数字化管理。包含检修计划、检修单、报修单三个核心功能，与设备档案、备件管理模块紧密关联，为设备KPI分析提供重要数据支撑。

### 📋 模块特点

- **业务流程完整**：计划 → 执行 → 验收的完整闭环管理
- **数据关联性强**：与设备档案、备件管理、人员排班等模块深度集成
- **多媒体支持**：支持图片、视频、语音等多种故障记录方式
- **移动端友好**：支持移动端报修和现场作业
- **统计分析丰富**：提供多维度统计分析和趋势预测

---

## 📊 数据库表设计

### 1. 检修计划管理表 (coal_maintenance_plan)

**表类型：单表**

```sql
CREATE TABLE `coal_maintenance_plan` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '计划ID',
  `plan_code` varchar(50) NOT NULL COMMENT '计划编号',
  `plan_name` varchar(100) NOT NULL COMMENT '计划名称',
  `plan_type` tinyint NOT NULL COMMENT '计划类型：1日计划 2周计划 3月计划 4年计划',
  `plan_status` tinyint NOT NULL DEFAULT '1' COMMENT '计划状态：1草稿 2待审批 3已审批 4执行中 5已完成 6已取消',
  `equipment_id` bigint NOT NULL COMMENT '设备ID',
  `equipment_name` varchar(100) NOT NULL COMMENT '设备名称',
  `maintenance_type` tinyint NOT NULL COMMENT '检修类型：1日常维护 2定期检修 3故障检修 4技术改造',
  `maintenance_level` tinyint NOT NULL COMMENT '检修级别：1小修 2中修 3大修',
  `planned_start_time` datetime NOT NULL COMMENT '计划开始时间',
  `planned_end_time` datetime NOT NULL COMMENT '计划结束时间',
  `estimated_duration` int NOT NULL COMMENT '预计工期(小时)',
  `responsible_person` varchar(50) NOT NULL COMMENT '负责人',
  `responsible_team` varchar(100) DEFAULT NULL COMMENT '负责班组',
  `maintenance_content` text COMMENT '检修内容',
  `safety_requirements` text COMMENT '安全要求',
  `required_tools` text COMMENT '所需工具',
  `required_materials` text COMMENT '所需材料',
  `budget_cost` decimal(10,2) DEFAULT NULL COMMENT '预算费用',
  `actual_cost` decimal(10,2) DEFAULT NULL COMMENT '实际费用',
  `approval_status` tinyint NOT NULL DEFAULT '1' COMMENT '审批状态：1待审批 2已审批 3已拒绝',
  `approver_id` bigint DEFAULT NULL COMMENT '审批人ID',
  `approval_time` datetime DEFAULT NULL COMMENT '审批时间',
  `approval_remark` varchar(500) DEFAULT NULL COMMENT '审批备注',
  `remark` varchar(500) DEFAULT NULL COMMENT '备注',
  `creator` varchar(64) DEFAULT '' COMMENT '创建者',
  `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `updater` varchar(64) DEFAULT '' COMMENT '更新者',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
  `deleted` bit(1) NOT NULL DEFAULT b'0' COMMENT '是否删除',
  `tenant_id` bigint NOT NULL DEFAULT '0' COMMENT '租户编号',
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_plan_code` (`plan_code`),
  KEY `idx_equipment_id` (`equipment_id`),
  KEY `idx_plan_status` (`plan_status`),
  KEY `idx_planned_time` (`planned_start_time`, `planned_end_time`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='检修计划表';
```

### 2. 检修单管理表 (coal_maintenance_order)

**表类型：主子表**

#### 主表：检修单
```sql
CREATE TABLE `coal_maintenance_order` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '检修单ID',
  `order_code` varchar(50) NOT NULL COMMENT '检修单编号',
  `plan_id` bigint DEFAULT NULL COMMENT '关联计划ID',
  `equipment_id` bigint NOT NULL COMMENT '设备ID',
  `equipment_name` varchar(100) NOT NULL COMMENT '设备名称',
  `maintenance_type` tinyint NOT NULL COMMENT '检修类型：1日常维护 2定期检修 3故障检修 4技术改造',
  `maintenance_level` tinyint NOT NULL COMMENT '检修级别：1小修 2中修 3大修',
  `order_status` tinyint NOT NULL DEFAULT '1' COMMENT '检修单状态：1待开始 2进行中 3待验收 4已完成 5已取消',
  `priority_level` tinyint NOT NULL DEFAULT '2' COMMENT '优先级：1低 2中 3高 4紧急',
  `fault_description` text COMMENT '故障描述',
  `maintenance_content` text COMMENT '检修内容',
  `safety_measures` text COMMENT '安全措施',
  `start_time` datetime DEFAULT NULL COMMENT '实际开始时间',
  `end_time` datetime DEFAULT NULL COMMENT '实际结束时间',
  `actual_duration` int DEFAULT NULL COMMENT '实际工期(小时)',
  `responsible_person` varchar(50) NOT NULL COMMENT '负责人',
  `responsible_team` varchar(100) DEFAULT NULL COMMENT '负责班组',
  `participants` text COMMENT '参与人员(JSON格式)',
  `work_environment` varchar(200) DEFAULT NULL COMMENT '作业环境',
  `weather_condition` varchar(50) DEFAULT NULL COMMENT '天气条件',
  `completion_rate` int DEFAULT '0' COMMENT '完成进度(%)',
  `quality_rating` tinyint DEFAULT NULL COMMENT '质量评级：1优秀 2良好 3合格 4不合格',
  `safety_rating` tinyint DEFAULT NULL COMMENT '安全评级：1优秀 2良好 3合格 4不合格',
  `maintenance_result` text COMMENT '检修结果',
  `problems_found` text COMMENT '发现问题',
  `improvement_suggestions` text COMMENT '改进建议',
  `next_maintenance_date` date DEFAULT NULL COMMENT '下次检修日期',
  `total_cost` decimal(10,2) DEFAULT NULL COMMENT '总费用',
  `labor_cost` decimal(10,2) DEFAULT NULL COMMENT '人工费用',
  `material_cost` decimal(10,2) DEFAULT NULL COMMENT '材料费用',
  `other_cost` decimal(10,2) DEFAULT NULL COMMENT '其他费用',
  `remark` varchar(500) DEFAULT NULL COMMENT '备注',
  `creator` varchar(64) DEFAULT '' COMMENT '创建者',
  `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `updater` varchar(64) DEFAULT '' COMMENT '更新者',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
  `deleted` bit(1) NOT NULL DEFAULT b'0' COMMENT '是否删除',
  `tenant_id` bigint NOT NULL DEFAULT '1' COMMENT '租户编号',
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_order_code` (`order_code`),
  KEY `idx_plan_id` (`plan_id`),
  KEY `idx_equipment_id` (`equipment_id`),
  KEY `idx_order_status` (`order_status`),
  KEY `idx_start_time` (`start_time`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='检修单表';
```

#### 子表：检修项目明细
```sql
CREATE TABLE `coal_maintenance_order_item` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '明细ID',
  `order_id` bigint NOT NULL COMMENT '检修单ID',
  `item_name` varchar(100) NOT NULL COMMENT '项目名称',
  `item_type` tinyint NOT NULL COMMENT '项目类型：1检查 2清洁 3润滑 4调整 5更换 6维修 7测试',
  `item_description` text COMMENT '项目描述',
  `work_standard` text COMMENT '作业标准',
  `safety_requirements` text COMMENT '安全要求',
  `required_tools` varchar(500) DEFAULT NULL COMMENT '所需工具',
  `required_materials` varchar(500) DEFAULT NULL COMMENT '所需材料',
  `estimated_duration` int DEFAULT NULL COMMENT '预计工时(小时)',
  `actual_duration` int DEFAULT NULL COMMENT '实际工时(小时)',
  `item_status` tinyint NOT NULL DEFAULT '1' COMMENT '项目状态：1待开始 2进行中 3已完成 4已跳过',
  `completion_time` datetime DEFAULT NULL COMMENT '完成时间',
  `completion_quality` tinyint DEFAULT NULL COMMENT '完成质量：1优秀 2良好 3合格 4不合格',
  `completion_notes` text COMMENT '完成说明',
  `inspector` varchar(50) DEFAULT NULL COMMENT '检查人',
  `inspection_time` datetime DEFAULT NULL COMMENT '检查时间',
  `inspection_result` text COMMENT '检查结果',
  `remark` varchar(500) DEFAULT NULL COMMENT '备注',
  `creator` varchar(64) DEFAULT '' COMMENT '创建者',
  `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `updater` varchar(64) DEFAULT '' COMMENT '更新者',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
  `deleted` bit(1) NOT NULL DEFAULT b'0' COMMENT '是否删除',
  `tenant_id` bigint NOT NULL DEFAULT '1' COMMENT '租户编号',
  PRIMARY KEY (`id`),
  KEY `idx_order_id` (`order_id`),
  KEY `idx_item_status` (`item_status`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='检修项目明细表';
```

### 3. 报修单管理表 (coal_repair_request)

**表类型：单表**

```sql
CREATE TABLE `coal_repair_request` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '报修单ID',
  `request_code` varchar(50) NOT NULL COMMENT '报修单编号',
  `equipment_id` bigint NOT NULL COMMENT '设备ID',
  `equipment_name` varchar(100) NOT NULL COMMENT '设备名称',
  `equipment_location` varchar(200) DEFAULT NULL COMMENT '设备位置',
  `fault_type` tinyint NOT NULL COMMENT '故障类型：1机械故障 2电气故障 3仪表故障 4其他故障',
  `fault_level` tinyint NOT NULL COMMENT '故障级别：1轻微 2一般 3严重 4紧急',
  `fault_description` text NOT NULL COMMENT '故障描述',
  `fault_symptoms` text COMMENT '故障现象',
  `fault_cause` text COMMENT '故障原因分析',
  `impact_assessment` text COMMENT '影响评估',
  `urgency_level` tinyint NOT NULL DEFAULT '2' COMMENT '紧急程度：1低 2中 3高 4紧急',
  `request_status` tinyint NOT NULL DEFAULT '1' COMMENT '报修状态：1待处理 2已派单 3处理中 4已完成 5已关闭',
  `reporter_id` bigint NOT NULL COMMENT '报修人ID',
  `reporter_name` varchar(50) NOT NULL COMMENT '报修人姓名',
  `reporter_phone` varchar(20) DEFAULT NULL COMMENT '报修人电话',
  `report_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '报修时间',
  `fault_photos` text COMMENT '故障照片(JSON格式)',
  `fault_videos` text COMMENT '故障视频(JSON格式)',
  `fault_audio` text COMMENT '故障语音(JSON格式)',
  `assigned_person` varchar(50) DEFAULT NULL COMMENT '指派处理人',
  `assigned_team` varchar(100) DEFAULT NULL COMMENT '指派班组',
  `assignment_time` datetime DEFAULT NULL COMMENT '派单时间',
  `expected_repair_time` datetime DEFAULT NULL COMMENT '预计修复时间',
  `actual_start_time` datetime DEFAULT NULL COMMENT '实际开始时间',
  `actual_end_time` datetime DEFAULT NULL COMMENT '实际结束时间',
  `repair_duration` int DEFAULT NULL COMMENT '修复耗时(小时)',
  `repair_method` text COMMENT '修复方法',
  `replaced_parts` text COMMENT '更换部件(JSON格式)',
  `repair_cost` decimal(10,2) DEFAULT NULL COMMENT '修复费用',
  `repair_quality` tinyint DEFAULT NULL COMMENT '修复质量：1优秀 2良好 3合格 4不合格',
  `test_result` text COMMENT '测试结果',
  `prevention_measures` text COMMENT '预防措施',
  `satisfaction_rating` tinyint DEFAULT NULL COMMENT '满意度评价：1非常满意 2满意 3一般 4不满意',
  `feedback_notes` text COMMENT '反馈意见',
  `close_time` datetime DEFAULT NULL COMMENT '关闭时间',
  `close_reason` varchar(200) DEFAULT NULL COMMENT '关闭原因',
  `remark` varchar(500) DEFAULT NULL COMMENT '备注',
  `creator` varchar(64) DEFAULT '' COMMENT '创建者',
  `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `updater` varchar(64) DEFAULT '' COMMENT '更新者',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
  `deleted` bit(1) NOT NULL DEFAULT b'0' COMMENT '是否删除',
  `tenant_id` bigint NOT NULL DEFAULT '0' COMMENT '租户编号',
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_request_code` (`request_code`),
  KEY `idx_equipment_id` (`equipment_id`),
  KEY `idx_request_status` (`request_status`),
  KEY `idx_fault_level` (`fault_level`),
  KEY `idx_report_time` (`report_time`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='报修单表';
```

---

## 📚 字典数据设计

### 1. 检修计划类型
```sql
INSERT INTO `system_dict_type` (`type`, `name`, `status`, `remark`) VALUES 
('maintenance_plan_type', '检修计划类型', 0, '检修计划的类型分类');

INSERT INTO `system_dict_data` (`sort`, `label`, `value`, `dict_type`, `status`, `color_type`, `remark`) VALUES
(1, '日计划', '1', 'maintenance_plan_type', 0, 'primary', '日常检修计划'),
(2, '周计划', '2', 'maintenance_plan_type', 0, 'success', '周度检修计划'),
(3, '月计划', '3', 'maintenance_plan_type', 0, 'warning', '月度检修计划'),
(4, '年计划', '4', 'maintenance_plan_type', 0, 'danger', '年度检修计划');
```

### 2. 检修类型
```sql
INSERT INTO `system_dict_type` (`type`, `name`, `status`, `remark`) VALUES 
('maintenance_type', '检修类型', 0, '检修工作的类型分类');

INSERT INTO `system_dict_data` (`sort`, `label`, `value`, `dict_type`, `status`, `color_type`, `remark`) VALUES
(1, '日常维护', '1', 'maintenance_type', 0, 'primary', '日常维护保养'),
(2, '定期检修', '2', 'maintenance_type', 0, 'success', '定期计划检修'),
(3, '故障检修', '3', 'maintenance_type', 0, 'warning', '故障应急检修'),
(4, '技术改造', '4', 'maintenance_type', 0, 'info', '技术改造检修');
```

### 3. 检修级别
```sql
INSERT INTO `system_dict_type` (`type`, `name`, `status`, `remark`) VALUES 
('maintenance_level', '检修级别', 0, '检修工作的级别分类');

INSERT INTO `system_dict_data` (`sort`, `label`, `value`, `dict_type`, `status`, `color_type`, `remark`) VALUES
(1, '小修', '1', 'maintenance_level', 0, 'primary', '小修级别'),
(2, '中修', '2', 'maintenance_level', 0, 'warning', '中修级别'),
(3, '大修', '3', 'maintenance_level', 0, 'danger', '大修级别');
```

### 4. 故障类型
```sql
INSERT INTO `system_dict_type` (`type`, `name`, `status`, `remark`) VALUES 
('fault_type', '故障类型', 0, '设备故障的类型分类');

INSERT INTO `system_dict_data` (`sort`, `label`, `value`, `dict_type`, `status`, `color_type`, `remark`) VALUES
(1, '机械故障', '1', 'fault_type', 0, 'primary', '机械类故障'),
(2, '电气故障', '2', 'fault_type', 0, 'warning', '电气类故障'),
(3, '仪表故障', '3', 'fault_type', 0, 'success', '仪表类故障'),
(4, '其他故障', '4', 'fault_type', 0, 'info', '其他类型故障');
```

### 5. 故障级别
```sql
INSERT INTO `system_dict_type` (`type`, `name`, `status`, `remark`) VALUES 
('fault_level', '故障级别', 0, '设备故障的严重程度分类');

INSERT INTO `system_dict_data` (`sort`, `label`, `value`, `dict_type`, `status`, `color_type`, `remark`) VALUES
(1, '轻微', '1', 'fault_level', 0, 'primary', '轻微故障'),
(2, '一般', '2', 'fault_level', 0, 'warning', '一般故障'),
(3, '严重', '3', 'fault_level', 0, 'danger', '严重故障'),
(4, '紧急', '4', 'fault_level', 0, 'danger', '紧急故障');
```

### 6. 计划状态
```sql
INSERT INTO `system_dict_type` (`type`, `name`, `status`, `remark`) VALUES 
('maintenance_plan_status', '检修计划状态', 0, '检修计划的状态分类');

INSERT INTO `system_dict_data` (`sort`, `label`, `value`, `dict_type`, `status`, `color_type`, `remark`) VALUES
(1, '草稿', '1', 'maintenance_plan_status', 0, 'info', '草稿状态'),
(2, '待审批', '2', 'maintenance_plan_status', 0, 'warning', '待审批状态'),
(3, '已审批', '3', 'maintenance_plan_status', 0, 'success', '已审批状态'),
(4, '执行中', '4', 'maintenance_plan_status', 0, 'primary', '执行中状态'),
(5, '已完成', '5', 'maintenance_plan_status', 0, 'success', '已完成状态'),
(6, '已取消', '6', 'maintenance_plan_status', 0, 'danger', '已取消状态');
```

### 7. 检修单状态
```sql
INSERT INTO `system_dict_type` (`type`, `name`, `status`, `remark`) VALUES 
('maintenance_order_status', '检修单状态', 0, '检修单的状态分类');

INSERT INTO `system_dict_data` (`sort`, `label`, `value`, `dict_type`, `status`, `color_type`, `remark`) VALUES
(1, '待开始', '1', 'maintenance_order_status', 0, 'info', '待开始状态'),
(2, '进行中', '2', 'maintenance_order_status', 0, 'primary', '进行中状态'),
(3, '待验收', '3', 'maintenance_order_status', 0, 'warning', '待验收状态'),
(4, '已完成', '4', 'maintenance_order_status', 0, 'success', '已完成状态'),
(5, '已取消', '5', 'maintenance_order_status', 0, 'danger', '已取消状态');
```

### 8. 报修单状态
```sql
INSERT INTO `system_dict_type` (`type`, `name`, `status`, `remark`) VALUES 
('repair_request_status', '报修单状态', 0, '报修单的状态分类');

INSERT INTO `system_dict_data` (`sort`, `label`, `value`, `dict_type`, `status`, `color_type`, `remark`) VALUES
(1, '待处理', '1', 'repair_request_status', 0, 'info', '待处理状态'),
(2, '已派单', '2', 'repair_request_status', 0, 'warning', '已派单状态'),
(3, '处理中', '3', 'repair_request_status', 0, 'primary', '处理中状态'),
(4, '已完成', '4', 'repair_request_status', 0, 'success', '已完成状态'),
(5, '已关闭', '5', 'repair_request_status', 0, 'danger', '已关闭状态');
```

### 9. 优先级
```sql
INSERT INTO `system_dict_type` (`type`, `name`, `status`, `remark`) VALUES 
('priority_level', '优先级', 0, '任务优先级分类');

INSERT INTO `system_dict_data` (`sort`, `label`, `value`, `dict_type`, `status`, `color_type`, `remark`) VALUES
(1, '低', '1', 'priority_level', 0, 'info', '低优先级'),
(2, '中', '2', 'priority_level', 0, 'primary', '中优先级'),
(3, '高', '3', 'priority_level', 0, 'warning', '高优先级'),
(4, '紧急', '4', 'priority_level', 0, 'danger', '紧急优先级');
```

### 10. 质量评级
```sql
INSERT INTO `system_dict_type` (`type`, `name`, `status`, `remark`) VALUES 
('quality_rating', '质量评级', 0, '工作质量评级分类');

INSERT INTO `system_dict_data` (`sort`, `label`, `value`, `dict_type`, `status`, `color_type`, `remark`) VALUES
(1, '优秀', '1', 'quality_rating', 0, 'success', '优秀评级'),
(2, '良好', '2', 'quality_rating', 0, 'primary', '良好评级'),
(3, '合格', '3', 'quality_rating', 0, 'warning', '合格评级'),
(4, '不合格', '4', 'quality_rating', 0, 'danger', '不合格评级');
```

### 11. 安全评级
```sql
INSERT INTO `system_dict_type` (`type`, `name`, `status`, `remark`) VALUES 
('safety_rating', '安全评级', 0, '安全作业评级分类');

INSERT INTO `system_dict_data` (`sort`, `label`, `value`, `dict_type`, `status`, `color_type`, `remark`) VALUES
(1, '优秀', '1', 'safety_rating', 0, 'success', '优秀安全评级'),
(2, '良好', '2', 'safety_rating', 0, 'primary', '良好安全评级'),
(3, '合格', '3', 'safety_rating', 0, 'warning', '合格安全评级'),
(4, '不合格', '4', 'safety_rating', 0, 'danger', '不合格安全评级');
```

### 12. 项目类型
```sql
INSERT INTO `system_dict_type` (`type`, `name`, `status`, `remark`) VALUES 
('maintenance_item_type', '检修项目类型', 0, '检修项目的类型分类');

INSERT INTO `system_dict_data` (`sort`, `label`, `value`, `dict_type`, `status`, `color_type`, `remark`) VALUES
(1, '检查', '1', 'maintenance_item_type', 0, 'primary', '检查类项目'),
(2, '清洁', '2', 'maintenance_item_type', 0, 'success', '清洁类项目'),
(3, '润滑', '3', 'maintenance_item_type', 0, 'warning', '润滑类项目'),
(4, '调整', '4', 'maintenance_item_type', 0, 'info', '调整类项目'),
(5, '更换', '5', 'maintenance_item_type', 0, 'danger', '更换类项目'),
(6, '维修', '6', 'maintenance_item_type', 0, 'warning', '维修类项目'),
(7, '测试', '7', 'maintenance_item_type', 0, 'primary', '测试类项目');
```

### 13. 项目状态
```sql
INSERT INTO `system_dict_type` (`type`, `name`, `status`, `remark`) VALUES 
('maintenance_item_status', '检修项目状态', 0, '检修项目的状态分类');

INSERT INTO `system_dict_data` (`sort`, `label`, `value`, `dict_type`, `status`, `color_type`, `remark`) VALUES
(1, '待开始', '1', 'maintenance_item_status', 0, 'info', '待开始状态'),
(2, '进行中', '2', 'maintenance_item_status', 0, 'primary', '进行中状态'),
(3, '已完成', '3', 'maintenance_item_status', 0, 'success', '已完成状态'),
(4, '已跳过', '4', 'maintenance_item_status', 0, 'warning', '已跳过状态');
```

### 14. 完成质量
```sql
INSERT INTO `system_dict_type` (`type`, `name`, `status`, `remark`) VALUES 
('completion_quality', '完成质量', 0, '项目完成质量评级分类');

INSERT INTO `system_dict_data` (`sort`, `label`, `value`, `dict_type`, `status`, `color_type`, `remark`) VALUES
(1, '优秀', '1', 'completion_quality', 0, 'success', '优秀完成质量'),
(2, '良好', '2', 'completion_quality', 0, 'primary', '良好完成质量'),
(3, '合格', '3', 'completion_quality', 0, 'warning', '合格完成质量'),
(4, '不合格', '4', 'completion_quality', 0, 'danger', '不合格完成质量');
```

### 15. 紧急程度
```sql
INSERT INTO `system_dict_type` (`type`, `name`, `status`, `remark`) VALUES 
('urgency_level', '紧急程度', 0, '报修紧急程度分类');

INSERT INTO `system_dict_data` (`sort`, `label`, `value`, `dict_type`, `status`, `color_type`, `remark`) VALUES
(1, '低', '1', 'urgency_level', 0, 'info', '低紧急程度'),
(2, '中', '2', 'urgency_level', 0, 'primary', '中紧急程度'),
(3, '高', '3', 'urgency_level', 0, 'warning', '高紧急程度'),
(4, '紧急', '4', 'urgency_level', 0, 'danger', '紧急程度');
```

### 16. 修复质量
```sql
INSERT INTO `system_dict_type` (`type`, `name`, `status`, `remark`) VALUES 
('repair_quality', '修复质量', 0, '修复工作质量评级分类');

INSERT INTO `system_dict_data` (`sort`, `label`, `value`, `dict_type`, `status`, `color_type`, `remark`) VALUES
(1, '优秀', '1', 'repair_quality', 0, 'success', '优秀修复质量'),
(2, '良好', '2', 'repair_quality', 0, 'primary', '良好修复质量'),
(3, '合格', '3', 'repair_quality', 0, 'warning', '合格修复质量'),
(4, '不合格', '4', 'repair_quality', 0, 'danger', '不合格修复质量');
```

### 17. 满意度评价
```sql
INSERT INTO `system_dict_type` (`type`, `name`, `status`, `remark`) VALUES 
('satisfaction_rating', '满意度评价', 0, '服务满意度评价分类');

INSERT INTO `system_dict_data` (`sort`, `label`, `value`, `dict_type`, `status`, `color_type`, `remark`) VALUES
(1, '非常满意', '1', 'satisfaction_rating', 0, 'success', '非常满意评价'),
(2, '满意', '2', 'satisfaction_rating', 0, 'primary', '满意评价'),
(3, '一般', '3', 'satisfaction_rating', 0, 'warning', '一般评价'),
(4, '不满意', '4', 'satisfaction_rating', 0, 'danger', '不满意评价');
```

---

## 🔄 业务逻辑设计

### 1. 检修计划管理业务逻辑

#### 核心流程
```
计划创建 → 计划审批 → 计划执行 → 计划完成
```

#### 关键业务规则
- **编号生成**：计划编号自动生成，格式：`MP` + 年月日 + 4位流水号
- **时间校验**：计划开始时间不能早于当前时间
- **状态流转**：草稿 → 待审批 → 已审批 → 执行中 → 已完成
- **审批控制**：只有审批通过的计划才能执行
- **修改限制**：执行中的计划不能修改基本信息
- **模板功能**：支持计划模板，提高创建效率

#### 数据关联
- **设备档案**：关联设备基本信息、位置、规格等
- **检修单**：一个计划可生成多个检修单
- **备件管理**：自动计算所需备件，生成备件需求清单
- **人员排班**：与排班管理关联，确保人员可用性

### 2. 检修单管理业务逻辑

#### 核心流程
```
检修单创建 → 项目分解 → 执行记录 → 质量验收 → 单子关闭
```

#### 关键业务规则
- **编号生成**：检修单编号自动生成，格式：`MO` + 年月日 + 4位流水号
- **计划关联**：支持从检修计划生成检修单
- **项目分解**：将检修工作分解为具体项目，支持并行执行
- **进度跟踪**：实时更新完成进度，支持百分比显示
- **质量验收**：检修完成后进行质量评级
- **费用统计**：自动计算人工、材料、其他费用

#### 数据关联
- **检修计划**：关联计划信息，继承计划参数
- **设备档案**：获取设备详细信息和历史记录
- **备件使用**：记录使用的备件，更新库存
- **人员管理**：关联负责人和参与人员信息

### 3. 报修单管理业务逻辑

#### 核心流程
```
故障报修 → 派单处理 → 故障诊断 → 修复执行 → 验收关闭
```

#### 关键业务规则
- **编号生成**：报修单编号自动生成，格式：`RR` + 年月日 + 4位流水号
- **紧急处理**：紧急故障自动提升优先级，发送通知
- **多媒体支持**：支持图片、视频、语音等故障记录
- **派单机制**：根据故障类型和级别自动分派或手动指派
- **质量评价**：修复完成后进行质量评价和满意度调查
- **预防措施**：根据故障原因自动生成预防措施建议

#### 数据关联
- **设备档案**：关联设备信息和故障历史
- **检修单**：严重故障可生成检修单
- **备件管理**：记录更换的备件，更新库存
- **人员管理**：关联报修人和处理人员

---

## 📊 统计报表设计

### 1. 检修计划完成率统计
- 按时间维度统计计划完成情况
- 按设备类型统计完成率
- 按负责人统计完成情况

### 2. 设备故障率统计
- 按设备统计故障频次
- 按故障类型统计分析
- 故障趋势分析

### 3. 检修费用统计
- 按时间统计检修费用
- 按设备统计费用分布
- 费用预算对比分析

### 4. 检修质量分析
- 质量评级分布统计
- 按负责人统计质量情况
- 质量改进趋势分析

### 5. 故障趋势分析
- 故障发生时间分布
- 故障类型趋势分析
- 预防措施效果评估

---

## 🚀 开发建议

### 开发顺序
1. **检修计划管理**（单表CRUD）
2. **检修单管理**（主子表CRUD）
3. **报修单管理**（单表CRUD）
4. **业务逻辑完善**
5. **统计报表功能**

### 技术要点
- 使用芋道框架的代码生成器生成基础CRUD
- 遵循框架的命名规范和代码结构
- 合理使用字典管理状态和类型
- 实现数据关联和业务逻辑
- 支持移动端操作

### 注意事项
- 确保数据一致性和完整性
- 实现合理的权限控制
- 支持多租户数据隔离
- 优化查询性能
- 提供友好的用户界面

---

## 📝 总结

检修管理模块设计完整，包含三个核心功能表，业务逻辑清晰，与现有模块关联性强。建议按照开发顺序逐步实现，先完成基础CRUD功能，再逐步完善业务逻辑和统计功能。

该模块将为选煤厂设备管理提供强有力的数字化支撑，提高检修效率，降低设备故障率，为设备KPI分析提供重要数据基础。
