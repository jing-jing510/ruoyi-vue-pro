# å¤‡ä»¶ç®¡ç†æ¨¡å—å®Œæ•´è®¾è®¡æ–‡æ¡£

## ğŸ“‹ ç›®å½•
1. [æ¨¡å—æ¦‚è¿°](#æ¨¡å—æ¦‚è¿°)
2. [æ•°æ®åº“è®¾è®¡](#æ•°æ®åº“è®¾è®¡)
3. [åŠŸèƒ½è§„åˆ’](#åŠŸèƒ½è§„åˆ’)
4. [ä¸šåŠ¡æµç¨‹](#ä¸šåŠ¡æµç¨‹)
5. [æŠ€æœ¯å®ç°](#æŠ€æœ¯å®ç°)
6. [APIè®¾è®¡](#apiè®¾è®¡)
7. [å‰ç«¯ç•Œé¢](#å‰ç«¯ç•Œé¢)

## ğŸ¯ æ¨¡å—æ¦‚è¿°

### 1.1 æ¨¡å—ç›®æ ‡
å¤‡ä»¶ç®¡ç†æ¨¡å—æ˜¯é€‰ç…¤å‚ç”Ÿäº§ç®¡ç†ç³»ç»Ÿçš„æ ¸å¿ƒæ¨¡å—ä¹‹ä¸€ï¼Œæ—¨åœ¨å®ç°å¤‡ä»¶çš„å…¨ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼ŒåŒ…æ‹¬ï¼š
- å¤‡ä»¶åŸºç¡€ä¿¡æ¯ç®¡ç†
- åº“å­˜å®æ—¶ç›‘æ§
- å‡ºå…¥åº“æµç¨‹ç®¡ç†
- é¢„è­¦æœºåˆ¶
- ç»Ÿè®¡åˆ†æ

### 1.2 æ ¸å¿ƒåŠŸèƒ½
- **å¤‡ä»¶åˆ†ç±»ç®¡ç†**: å»ºç«‹å¤‡ä»¶åˆ†ç±»ä½“ç³»
- **å¤‡ä»¶åŸºç¡€ä¿¡æ¯ç®¡ç†**: å¤‡ä»¶æ¡£æ¡ˆã€è§„æ ¼ã€ä»·æ ¼ç­‰
- **åº“å­˜ç®¡ç†**: å®æ—¶åº“å­˜ç›‘æ§ã€è‡ªåŠ¨æ›´æ–°
- **å‡ºå…¥åº“ç®¡ç†**: å®Œæ•´çš„å‡ºå…¥åº“æµç¨‹
- **é¢„è­¦ç³»ç»Ÿ**: ä½åº“å­˜ã€é›¶åº“å­˜é¢„è­¦
- **ç»Ÿè®¡åˆ†æ**: åº“å­˜ç»Ÿè®¡ã€ä½¿ç”¨åˆ†æ
- **è®¾å¤‡å…³è”**: å¤‡ä»¶ä¸è®¾å¤‡çš„å…³è”å…³ç³»

## ğŸ—„ï¸ æ•°æ®åº“è®¾è®¡

### 2.1 æ ¸å¿ƒè¡¨ç»“æ„

#### 2.1.1 å¤‡ä»¶åˆ†ç±»è¡¨ (coal_spare_part_category)
```sql
CREATE TABLE `coal_spare_part_category` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT 'åˆ†ç±»ID',
  `category_name` varchar(100) NOT NULL COMMENT 'åˆ†ç±»åç§°',
  `parent_id` bigint DEFAULT '0' COMMENT 'çˆ¶åˆ†ç±»ID',
  `category_code` varchar(50) DEFAULT NULL COMMENT 'åˆ†ç±»ç¼–ç ',
  `description` varchar(500) DEFAULT NULL COMMENT 'åˆ†ç±»æè¿°',
  `sort_order` int DEFAULT '0' COMMENT 'æ’åº',
  `status` tinyint NOT NULL DEFAULT '1' COMMENT 'çŠ¶æ€',
  `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'æ›´æ–°æ—¶é—´',
  `creator` varchar(64) DEFAULT '' COMMENT 'åˆ›å»ºè€…',
  `updater` varchar(64) DEFAULT '' COMMENT 'æ›´æ–°è€…',
  `deleted` bit(1) NOT NULL DEFAULT b'0' COMMENT 'æ˜¯å¦åˆ é™¤',
  `tenant_id` bigint NOT NULL DEFAULT '0' COMMENT 'ç§Ÿæˆ·ç¼–å·',
  PRIMARY KEY (`id`) USING BTREE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='å¤‡ä»¶åˆ†ç±»è¡¨';
```

#### 2.1.2 å¤‡ä»¶åŸºç¡€ä¿¡æ¯è¡¨ (coal_spare_part_info)
```sql
CREATE TABLE `coal_spare_part_info` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT 'å¤‡ä»¶ID',
  `spare_part_code` varchar(100) NOT NULL COMMENT 'å¤‡ä»¶ç¼–å·',
  `spare_part_name` varchar(200) NOT NULL COMMENT 'å¤‡ä»¶åç§°',
  `category_id` bigint NOT NULL COMMENT 'å¤‡ä»¶åˆ†ç±»ID',
  `specification` varchar(500) NOT NULL COMMENT 'è§„æ ¼å‹å·',
  `brand` varchar(100) NOT NULL COMMENT 'å“ç‰Œ',
  `unit` varchar(20) NOT NULL COMMENT 'è®¡é‡å•ä½',
  `spare_part_type` int DEFAULT NULL COMMENT 'å¤‡ä»¶ç±»å‹',
  `material` varchar(100) DEFAULT NULL COMMENT 'æè´¨',
  `weight` decimal(10,2) DEFAULT NULL COMMENT 'é‡é‡(kg)',
  `dimensions` varchar(200) DEFAULT NULL COMMENT 'å¤–å½¢å°ºå¯¸',
  `min_stock` decimal(10,2) DEFAULT NULL COMMENT 'æœ€ä½åº“å­˜é¢„è­¦æ•°é‡',
  `max_stock` decimal(10,2) DEFAULT NULL COMMENT 'æœ€é«˜åº“å­˜æ•°é‡',
  `safety_stock` decimal(10,2) DEFAULT NULL COMMENT 'å®‰å…¨åº“å­˜æ•°é‡',
  `current_stock` decimal(10,2) DEFAULT '0.00' COMMENT 'å½“å‰åº“å­˜æ•°é‡',
  `unit_price` decimal(10,2) DEFAULT NULL COMMENT 'å•ä»·',
  `supplier` varchar(200) DEFAULT NULL COMMENT 'ä¾›åº”å•†',
  `supplier_contact` varchar(100) DEFAULT NULL COMMENT 'ä¾›åº”å•†è”ç³»æ–¹å¼',
  `purchase_lead_time` int DEFAULT NULL COMMENT 'é‡‡è´­å‘¨æœŸ(å¤©)',
  `is_critical` tinyint(1) NOT NULL DEFAULT '0' COMMENT 'æ˜¯å¦å…³é”®å¤‡ä»¶',
  `image_url` varchar(500) DEFAULT NULL COMMENT 'å¤‡ä»¶å›¾ç‰‡URL',
  `manual_url` varchar(500) DEFAULT NULL COMMENT 'è¯´æ˜ä¹¦æ–‡ä»¶URL',
  `drawing_url` varchar(500) DEFAULT NULL COMMENT 'å›¾çº¸æ–‡ä»¶URL',
  `remark` text COMMENT 'å¤‡æ³¨',
  `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'æ›´æ–°æ—¶é—´',
  `creator` varchar(64) DEFAULT '' COMMENT 'åˆ›å»ºè€…',
  `updater` varchar(64) DEFAULT '' COMMENT 'æ›´æ–°è€…',
  `deleted` bit(1) NOT NULL DEFAULT b'0' COMMENT 'æ˜¯å¦åˆ é™¤',
  `tenant_id` bigint NOT NULL DEFAULT '0' COMMENT 'ç§Ÿæˆ·ç¼–å·',
  PRIMARY KEY (`id`) USING BTREE,
  UNIQUE KEY `uk_spare_part_code` (`spare_part_code`) USING BTREE,
  KEY `idx_category_id` (`category_id`) USING BTREE,
  KEY `idx_spare_part_name` (`spare_part_name`) USING BTREE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='å¤‡ä»¶åŸºç¡€ä¿¡æ¯è¡¨';
```

#### 2.1.3 å¤‡ä»¶åº“å­˜è®°å½•è¡¨ (coal_spare_part_stock)
```sql
CREATE TABLE `coal_spare_part_stock` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT 'åº“å­˜è®°å½•ID',
  `spare_part_id` bigint NOT NULL COMMENT 'å¤‡ä»¶ID',
  `warehouse_location` varchar(100) NOT NULL COMMENT 'ä»“åº“ä½ç½®',
  `stock_type` int DEFAULT NULL COMMENT 'åº“å­˜ç±»å‹',
  `quantity` decimal(10,2) DEFAULT NULL COMMENT 'åº“å­˜æ•°é‡',
  `unit_cost` decimal(10,2) DEFAULT NULL COMMENT 'å•ä½æˆæœ¬',
  `total_cost` decimal(10,2) DEFAULT NULL COMMENT 'æ€»æˆæœ¬',
  `batch_no` varchar(100) DEFAULT NULL COMMENT 'æ‰¹æ¬¡å·',
  `production_date` date DEFAULT NULL COMMENT 'ç”Ÿäº§æ—¥æœŸ',
  `expiry_date` date DEFAULT NULL COMMENT 'æœ‰æ•ˆæœŸè‡³',
  `last_in_date` datetime DEFAULT NULL COMMENT 'æœ€åå…¥åº“æ—¶é—´',
  `last_out_date` datetime DEFAULT NULL COMMENT 'æœ€åå‡ºåº“æ—¶é—´',
  `remark` varchar(500) DEFAULT NULL COMMENT 'å¤‡æ³¨',
  `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'æ›´æ–°æ—¶é—´',
  `creator` varchar(64) DEFAULT '' COMMENT 'åˆ›å»ºè€…',
  `updater` varchar(64) DEFAULT '' COMMENT 'æ›´æ–°è€…',
  `deleted` bit(1) NOT NULL DEFAULT b'0' COMMENT 'æ˜¯å¦åˆ é™¤',
  `tenant_id` bigint NOT NULL DEFAULT '0' COMMENT 'ç§Ÿæˆ·ç¼–å·',
  PRIMARY KEY (`id`) USING BTREE,
  KEY `idx_spare_part` (`spare_part_id`) USING BTREE,
  KEY `idx_warehouse` (`warehouse_location`) USING BTREE,
  KEY `idx_stock_type` (`stock_type`) USING BTREE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='å¤‡ä»¶åº“å­˜è®°å½•è¡¨';
```

#### 2.1.4 å¤‡ä»¶å‡ºå…¥åº“è®°å½•è¡¨ (coal_spare_part_inventory_log)
```sql
CREATE TABLE `coal_spare_part_inventory_log` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT 'è®°å½•ID',
  `spare_part_id` bigint NOT NULL COMMENT 'å¤‡ä»¶ID',
  `operation_type` int NOT NULL COMMENT 'æ“ä½œç±»å‹ï¼š1-å…¥åº“ï¼Œ2-å‡ºåº“',
  `operation_date` datetime NOT NULL COMMENT 'æ“ä½œæ—¶é—´',
  `quantity` decimal(10,2) NOT NULL COMMENT 'æ•°é‡',
  `unit_price` decimal(10,2) DEFAULT NULL COMMENT 'å•ä»·',
  `total_amount` decimal(10,2) DEFAULT NULL COMMENT 'æ€»é‡‘é¢',
  `operator_id` bigint NOT NULL COMMENT 'æ“ä½œäººå‘˜ID',
  `warehouse_location` varchar(100) NOT NULL COMMENT 'ä»“åº“ä½ç½®',
  `batch_no` varchar(100) DEFAULT NULL COMMENT 'æ‰¹æ¬¡å·',
  `equipment_id` bigint DEFAULT NULL COMMENT 'å…³è”è®¾å¤‡ID',
  `work_order_id` bigint DEFAULT NULL COMMENT 'å·¥å•ID',
  `supplier_id` bigint DEFAULT NULL COMMENT 'ä¾›åº”å•†ID',
  `purchase_order_no` varchar(100) DEFAULT NULL COMMENT 'é‡‡è´­å•å·',
  `approver_id` bigint DEFAULT NULL COMMENT 'å®¡æ‰¹äººID',
  `approve_time` datetime DEFAULT NULL COMMENT 'å®¡æ‰¹æ—¶é—´',
  `approve_status` int DEFAULT '0' COMMENT 'å®¡æ‰¹çŠ¶æ€ï¼š0-å¾…å®¡æ‰¹ï¼Œ1-å·²å®¡æ‰¹ï¼Œ2-å·²æ‹’ç»',
  `operation_reason` varchar(500) DEFAULT NULL COMMENT 'æ“ä½œåŸå› ',
  `remark` varchar(500) DEFAULT NULL COMMENT 'å¤‡æ³¨',
  `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'æ›´æ–°æ—¶é—´',
  `creator` varchar(64) DEFAULT '' COMMENT 'åˆ›å»ºè€…',
  `updater` varchar(64) DEFAULT '' COMMENT 'æ›´æ–°è€…',
  `deleted` bit(1) NOT NULL DEFAULT b'0' COMMENT 'æ˜¯å¦åˆ é™¤',
  `tenant_id` bigint NOT NULL DEFAULT '0' COMMENT 'ç§Ÿæˆ·ç¼–å·',
  PRIMARY KEY (`id`) USING BTREE,
  KEY `idx_spare_part` (`spare_part_id`) USING BTREE,
  KEY `idx_operation_type` (`operation_type`) USING BTREE,
  KEY `idx_operation_date` (`operation_date`) USING BTREE,
  KEY `idx_equipment` (`equipment_id`) USING BTREE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='å¤‡ä»¶å‡ºå…¥åº“è®°å½•è¡¨';
```

#### 2.1.5 å¤‡ä»¶ä½¿ç”¨è®°å½•è¡¨ (coal_spare_part_usage_record)
```sql
CREATE TABLE `coal_spare_part_usage_record` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT 'è®°å½•ID',
  `spare_part_id` bigint NOT NULL COMMENT 'å¤‡ä»¶ID',
  `equipment_id` bigint NOT NULL COMMENT 'è®¾å¤‡ID',
  `usage_date` datetime NOT NULL COMMENT 'ä½¿ç”¨æ—¥æœŸ',
  `usage_quantity` decimal(10,2) NOT NULL COMMENT 'ä½¿ç”¨æ•°é‡',
  `usage_reason` varchar(500) DEFAULT NULL COMMENT 'ä½¿ç”¨åŸå› ',
  `operator_id` bigint NOT NULL COMMENT 'æ“ä½œäººå‘˜ID',
  `work_order_id` bigint DEFAULT NULL COMMENT 'å·¥å•ID',
  `remark` varchar(500) DEFAULT NULL COMMENT 'å¤‡æ³¨',
  `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'æ›´æ–°æ—¶é—´',
  `creator` varchar(64) DEFAULT '' COMMENT 'åˆ›å»ºè€…',
  `updater` varchar(64) DEFAULT '' COMMENT 'æ›´æ–°è€…',
  `deleted` bit(1) NOT NULL DEFAULT b'0' COMMENT 'æ˜¯å¦åˆ é™¤',
  `tenant_id` bigint NOT NULL DEFAULT '0' COMMENT 'ç§Ÿæˆ·ç¼–å·',
  PRIMARY KEY (`id`) USING BTREE,
  KEY `idx_spare_part` (`spare_part_id`) USING BTREE,
  KEY `idx_equipment` (`equipment_id`) USING BTREE,
  KEY `idx_usage_date` (`usage_date`) USING BTREE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='å¤‡ä»¶ä½¿ç”¨è®°å½•è¡¨';
```

#### 2.1.6 å¤‡ä»¶é¢„è­¦è®°å½•è¡¨ (coal_spare_part_alert)
```sql
CREATE TABLE `coal_spare_part_alert` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT 'é¢„è­¦ID',
  `spare_part_id` bigint NOT NULL COMMENT 'å¤‡ä»¶ID',
  `equipment_id` bigint DEFAULT NULL COMMENT 'è®¾å¤‡ID',
  `alert_type` int NOT NULL COMMENT 'é¢„è­¦ç±»å‹ï¼š1-ä½åº“å­˜ï¼Œ2-é›¶åº“å­˜ï¼Œ3-è¶…é‡åº“å­˜',
  `alert_level` int NOT NULL COMMENT 'é¢„è­¦çº§åˆ«ï¼š1-ä½ï¼Œ2-ä¸­ï¼Œ3-é«˜',
  `current_stock` decimal(10,2) NOT NULL COMMENT 'å½“å‰åº“å­˜',
  `threshold_value` decimal(10,2) NOT NULL COMMENT 'é˜ˆå€¼',
  `alert_message` varchar(500) NOT NULL COMMENT 'é¢„è­¦ä¿¡æ¯',
  `alert_time` datetime NOT NULL COMMENT 'é¢„è­¦æ—¶é—´',
  `status` int NOT NULL DEFAULT '0' COMMENT 'å¤„ç†çŠ¶æ€ï¼š0-æœªå¤„ç†ï¼Œ1-å·²å¤„ç†',
  `handler_id` bigint DEFAULT NULL COMMENT 'å¤„ç†äººID',
  `handle_time` datetime DEFAULT NULL COMMENT 'å¤„ç†æ—¶é—´',
  `handle_result` varchar(500) DEFAULT NULL COMMENT 'å¤„ç†ç»“æœ',
  `remark` varchar(500) DEFAULT NULL COMMENT 'å¤‡æ³¨',
  `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'æ›´æ–°æ—¶é—´',
  `creator` varchar(64) DEFAULT '' COMMENT 'åˆ›å»ºè€…',
  `updater` varchar(64) DEFAULT '' COMMENT 'æ›´æ–°è€…',
  `deleted` bit(1) NOT NULL DEFAULT b'0' COMMENT 'æ˜¯å¦åˆ é™¤',
  `tenant_id` bigint NOT NULL DEFAULT '0' COMMENT 'ç§Ÿæˆ·ç¼–å·',
  PRIMARY KEY (`id`) USING BTREE,
  KEY `idx_spare_part` (`spare_part_id`) USING BTREE,
  KEY `idx_equipment` (`equipment_id`) USING BTREE,
  KEY `idx_alert_type` (`alert_type`) USING BTREE,
  KEY `idx_alert_time` (`alert_time`) USING BTREE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='å¤‡ä»¶é¢„è­¦è®°å½•è¡¨';
```

#### 2.1.7 å¤‡ä»¶è®¾å¤‡å…³è”è¡¨ (coal_spare_part_equipment)
```sql
CREATE TABLE `coal_spare_part_equipment` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT 'å…³è”ID',
  `spare_part_id` bigint NOT NULL COMMENT 'å¤‡ä»¶ID',
  `equipment_id` bigint NOT NULL COMMENT 'è®¾å¤‡ID',
  `is_required` tinyint(1) NOT NULL DEFAULT '1' COMMENT 'æ˜¯å¦å¿…éœ€',
  `replacement_difficulty` int DEFAULT '1' COMMENT 'æ›´æ¢éš¾åº¦ï¼š1-ç®€å•ï¼Œ2-ä¸­ç­‰ï¼Œ3-å›°éš¾',
  `usage_frequency` int DEFAULT '1' COMMENT 'ä½¿ç”¨é¢‘ç‡ï¼š1-ä½ï¼Œ2-ä¸­ï¼Œ3-é«˜',
  `last_replacement_date` date DEFAULT NULL COMMENT 'æœ€åæ›´æ¢æ—¥æœŸ',
  `next_maintenance_date` date DEFAULT NULL COMMENT 'ä¸‹æ¬¡ç»´æŠ¤æ—¥æœŸ',
  `remark` varchar(500) DEFAULT NULL COMMENT 'å¤‡æ³¨',
  `create_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',
  `update_time` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'æ›´æ–°æ—¶é—´',
  `creator` varchar(64) DEFAULT '' COMMENT 'åˆ›å»ºè€…',
  `updater` varchar(64) DEFAULT '' COMMENT 'æ›´æ–°è€…',
  `deleted` bit(1) NOT NULL DEFAULT b'0' COMMENT 'æ˜¯å¦åˆ é™¤',
  `tenant_id` bigint NOT NULL DEFAULT '0' COMMENT 'ç§Ÿæˆ·ç¼–å·',
  PRIMARY KEY (`id`) USING BTREE,
  KEY `idx_spare_part` (`spare_part_id`) USING BTREE,
  KEY `idx_equipment` (`equipment_id`) USING BTREE,
  UNIQUE KEY `uk_spare_part_equipment` (`spare_part_id`, `equipment_id`) USING BTREE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='å¤‡ä»¶è®¾å¤‡å…³è”è¡¨';
```

### 2.2 è¡¨å…³ç³»å›¾
```mermaid
graph TD
    A[å¤‡ä»¶åˆ†ç±»è¡¨] --> B[å¤‡ä»¶åŸºç¡€ä¿¡æ¯è¡¨]
    B --> C[å¤‡ä»¶è®¾å¤‡å…³è”è¡¨]
    B --> D[å¤‡ä»¶åº“å­˜è®°å½•è¡¨]
    B --> E[å¤‡ä»¶å‡ºå…¥åº“è®°å½•è¡¨]
    B --> F[å¤‡ä»¶é¢„è­¦è®°å½•è¡¨]
    B --> G[å¤‡ä»¶ä½¿ç”¨è®°å½•è¡¨]
    
    H[è®¾å¤‡æ¡£æ¡ˆè¡¨] --> C
    H --> E
    H --> F
    H --> G
    
    C --> |ä¸»å­è¡¨å…³ç³»| B
```

## ğŸ¯ åŠŸèƒ½è§„åˆ’

### 3.1 æ ¸å¿ƒåŠŸèƒ½æ¨¡å—

#### 3.1.1 å¤‡ä»¶åˆ†ç±»ç®¡ç†
- **åŠŸèƒ½æè¿°**: å»ºç«‹å¤‡ä»¶åˆ†ç±»ä½“ç³»ï¼Œæ”¯æŒå¤šçº§åˆ†ç±»
- **ä¸»è¦æ“ä½œ**: æ–°å¢ã€ç¼–è¾‘ã€åˆ é™¤ã€æŸ¥è¯¢åˆ†ç±»
- **ä¸šåŠ¡è§„åˆ™**: 
  - æ”¯æŒæ ‘å½¢ç»“æ„åˆ†ç±»
  - åˆ†ç±»ç¼–ç å”¯ä¸€æ€§
  - åˆ é™¤åˆ†ç±»å‰æ£€æŸ¥æ˜¯å¦æœ‰å…³è”å¤‡ä»¶

#### 3.1.2 å¤‡ä»¶åŸºç¡€ä¿¡æ¯ç®¡ç†
- **åŠŸèƒ½æè¿°**: ç®¡ç†å¤‡ä»¶çš„åŸºæœ¬ä¿¡æ¯ã€è§„æ ¼å‚æ•°ã€ä»·æ ¼ç­‰
- **ä¸»è¦æ“ä½œ**: æ–°å¢ã€ç¼–è¾‘ã€åˆ é™¤ã€æŸ¥è¯¢å¤‡ä»¶ä¿¡æ¯
- **ä¸šåŠ¡è§„åˆ™**:
  - å¤‡ä»¶ç¼–å·å”¯ä¸€æ€§
  - æ”¯æŒå›¾ç‰‡ã€è¯´æ˜ä¹¦ã€å›¾çº¸æ–‡ä»¶ä¸Šä¼ 
  - å…³é”®å¤‡ä»¶æ ‡è¯†
  - åº“å­˜é˜ˆå€¼è®¾ç½®

#### 3.1.3 åº“å­˜ç®¡ç†
- **åŠŸèƒ½æè¿°**: å®æ—¶ç›‘æ§å¤‡ä»¶åº“å­˜çŠ¶æ€
- **ä¸»è¦æ“ä½œ**: åº“å­˜æŸ¥è¯¢ã€åº“å­˜è°ƒæ•´ã€åº“å­˜é¢„è­¦
- **ä¸šåŠ¡è§„åˆ™**:
  - å®æ—¶åº“å­˜è®¡ç®—
  - è‡ªåŠ¨åº“å­˜æ›´æ–°
  - åº“å­˜é¢„è­¦æœºåˆ¶

#### 3.1.4 å‡ºå…¥åº“ç®¡ç†
- **åŠŸèƒ½æè¿°**: ç®¡ç†å¤‡ä»¶çš„å…¥åº“å’Œå‡ºåº“æ“ä½œ
- **ä¸»è¦æ“ä½œ**: å…¥åº“ç™»è®°ã€å‡ºåº“ç™»è®°ã€å®¡æ‰¹æµç¨‹
- **ä¸šåŠ¡è§„åˆ™**:
  - å‡ºå…¥åº“å®¡æ‰¹æµç¨‹
  - è‡ªåŠ¨åº“å­˜æ›´æ–°
  - æ‰¹æ¬¡ç®¡ç†
  - å…³è”è®¾å¤‡è®°å½•

#### 3.1.5 ä½¿ç”¨è®°å½•ç®¡ç†
- **åŠŸèƒ½æè¿°**: è®°å½•å¤‡ä»¶çš„ä½¿ç”¨æƒ…å†µ
- **ä¸»è¦æ“ä½œ**: ä½¿ç”¨ç™»è®°ã€ä½¿ç”¨æŸ¥è¯¢ã€ä½¿ç”¨åˆ†æ
- **ä¸šåŠ¡è§„åˆ™**:
  - ä½¿ç”¨è®°å½•ä¸åº“å­˜è”åŠ¨
  - è®¾å¤‡å…³è”è®°å½•
  - ä½¿ç”¨åŸå› è®°å½•

#### 3.1.6 é¢„è­¦ç®¡ç†
- **åŠŸèƒ½æè¿°**: åº“å­˜é¢„è­¦å’Œå¼‚å¸¸æé†’
- **ä¸»è¦æ“ä½œ**: é¢„è­¦æŸ¥çœ‹ã€é¢„è­¦å¤„ç†ã€é¢„è­¦é…ç½®
- **ä¸šåŠ¡è§„åˆ™**:
  - è‡ªåŠ¨é¢„è­¦è§¦å‘
  - å¤šçº§é¢„è­¦æœºåˆ¶
  - é¢„è­¦å¤„ç†è·Ÿè¸ª

#### 3.1.7 è®¾å¤‡å…³è”ç®¡ç†
- **åŠŸèƒ½æè¿°**: ç®¡ç†å¤‡ä»¶ä¸è®¾å¤‡çš„å…³è”å…³ç³»
- **ä¸»è¦æ“ä½œ**: å…³è”é…ç½®ã€å…³è”æŸ¥è¯¢ã€ç»´æŠ¤è®¡åˆ’
- **ä¸šåŠ¡è§„åˆ™**:
  - ä¸»å­è¡¨å…³ç³»ç®¡ç†
  - æ›´æ¢éš¾åº¦è¯„ä¼°
  - ç»´æŠ¤è®¡åˆ’åˆ¶å®š

#### 3.1.8 ç»Ÿè®¡åˆ†æ
- **åŠŸèƒ½æè¿°**: å¤‡ä»¶ä½¿ç”¨å’Œåº“å­˜ç»Ÿè®¡åˆ†æ
- **ä¸»è¦æ“ä½œ**: åº“å­˜ç»Ÿè®¡ã€ä½¿ç”¨åˆ†æã€è¶‹åŠ¿åˆ†æ
- **ä¸šåŠ¡è§„åˆ™**:
  - å¤šç»´åº¦ç»Ÿè®¡åˆ†æ
  - å›¾è¡¨å±•ç¤º
  - æ•°æ®å¯¼å‡º

## ğŸ”„ ä¸šåŠ¡æµç¨‹

### 4.1 å¤‡ä»¶å…¥åº“æµç¨‹
```mermaid
graph TD
    A[é‡‡è´­åˆ°è´§] --> B[å…¥åº“ç™»è®°]
    B --> C[å¡«å†™å…¥åº“ä¿¡æ¯]
    C --> D[æäº¤å®¡æ‰¹]
    D --> E{å®¡æ‰¹é€šè¿‡?}
    E -->|æ˜¯| F[ç¡®è®¤å…¥åº“]
    E -->|å¦| G[é€€å›ä¿®æ”¹]
    F --> H[æ›´æ–°åº“å­˜]
    H --> I[ç”Ÿæˆå…¥åº“è®°å½•]
    I --> J[æ£€æŸ¥é¢„è­¦]
```

### 4.2 å¤‡ä»¶å‡ºåº“æµç¨‹
```mermaid
graph TD
    A[ä½¿ç”¨éœ€æ±‚] --> B[å‡ºåº“ç”³è¯·]
    B --> C[å¡«å†™å‡ºåº“ä¿¡æ¯]
    C --> D[æäº¤å®¡æ‰¹]
    D --> E{å®¡æ‰¹é€šè¿‡?}
    E -->|æ˜¯| F[ç¡®è®¤å‡ºåº“]
    E -->|å¦| G[é€€å›ä¿®æ”¹]
    F --> H[æ›´æ–°åº“å­˜]
    H --> I[ç”Ÿæˆå‡ºåº“è®°å½•]
    I --> J[æ£€æŸ¥é¢„è­¦]
    J --> K[è®°å½•ä½¿ç”¨æƒ…å†µ]
```

### 4.3 é¢„è­¦å¤„ç†æµç¨‹
```mermaid
graph TD
    A[åº“å­˜å˜åŒ–] --> B[æ£€æŸ¥é˜ˆå€¼]
    B --> C{è§¦å‘é¢„è­¦?}
    C -->|æ˜¯| D[ç”Ÿæˆé¢„è­¦è®°å½•]
    C -->|å¦| E[æ­£å¸¸æµç¨‹]
    D --> F[å‘é€é¢„è­¦é€šçŸ¥]
    F --> G[å¤„ç†é¢„è­¦]
    G --> H[æ›´æ–°å¤„ç†çŠ¶æ€]
```

## ğŸ› ï¸ æŠ€æœ¯å®ç°

### 5.1 åç«¯æŠ€æœ¯æ ˆ
- **æ¡†æ¶**: Spring Boot 2.7.x
- **æ•°æ®åº“**: MySQL 8.0
- **ORM**: MyBatis-Plus
- **ç¼“å­˜**: Redis
- **æ¶ˆæ¯é˜Ÿåˆ—**: RabbitMQ
- **æ–‡ä»¶å­˜å‚¨**: æœ¬åœ°å­˜å‚¨/OSS

### 5.2 å‰ç«¯æŠ€æœ¯æ ˆ
- **æ¡†æ¶**: Vue 3 + TypeScript
- **UIç»„ä»¶**: Element Plus
- **çŠ¶æ€ç®¡ç†**: Pinia
- **è·¯ç”±**: Vue Router
- **å›¾è¡¨**: ECharts
- **æ„å»ºå·¥å…·**: Vite

### 5.3 æ ¸å¿ƒå®ç°

#### 5.3.1 åº“å­˜è‡ªåŠ¨æ›´æ–°æœºåˆ¶
```java
@Service
public class SparePartInventoryLogServiceImpl implements SparePartInventoryLogService {
    
    @Override
    @Transactional(rollbackFor = Exception.class)
    public Long createSparePartInventoryLog(SparePartInventoryLogSaveReqVO createReqVO) {
        // åˆ›å»ºå‡ºå…¥åº“è®°å½•
        SparePartInventoryLogDO inventoryLog = BeanUtils.toBean(createReqVO, SparePartInventoryLogDO.class);
        sparePartInventoryLogMapper.insert(inventoryLog);
        
        // è‡ªåŠ¨æ›´æ–°åº“å­˜
        updateStockQuantity(inventoryLog);
        
        // æ£€æŸ¥å¹¶åˆ›å»ºé¢„è­¦
        checkAndCreateAlert(inventoryLog.getSparePartId());
        
        return inventoryLog.getId();
    }
    
    private void updateStockQuantity(SparePartInventoryLogDO log) {
        if (log.getQuantity().compareTo(BigDecimal.ZERO) > 0) {
            // å…¥åº“æ“ä½œ
            sparePartStockService.increaseStock(log.getSparePartId(), log.getQuantity());
        } else {
            // å‡ºåº“æ“ä½œ
            sparePartStockService.decreaseStock(log.getSparePartId(), log.getQuantity().abs());
        }
    }
}
```

#### 5.3.2 é¢„è­¦è‡ªåŠ¨è§¦å‘æœºåˆ¶
```java
@Service
public class SparePartAlertServiceImpl implements SparePartAlertService {
    
    public void checkAndCreateAlert(Long sparePartId) {
        SparePartInfoDO sparePart = sparePartInfoService.getSparePartInfo(sparePartId);
        BigDecimal currentStock = sparePartStockService.getCurrentStock(sparePartId);
        
        if (currentStock.compareTo(BigDecimal.ZERO) == 0) {
            // é›¶åº“å­˜é¢„è­¦
            createAlert(sparePartId, 2, 3, currentStock, BigDecimal.ZERO, "é›¶åº“å­˜é¢„è­¦");
        } else if (sparePart.getMinStock() != null && 
                   currentStock.compareTo(sparePart.getMinStock()) <= 0) {
            // ä½åº“å­˜é¢„è­¦
            createAlert(sparePartId, 1, 2, currentStock, sparePart.getMinStock(), "ä½åº“å­˜é¢„è­¦");
        }
    }
}
```

#### 5.3.3 ç»Ÿè®¡æ•°æ®åˆ†æ
```java
@Service
public class SparePartInfoServiceImpl implements SparePartInfoService {
    
    @Override
    public SparePartStockStatisticsRespVO getStockStatistics() {
        SparePartStockStatisticsRespVO statistics = new SparePartStockStatisticsRespVO();
        List<SparePartInfoDO> allSpareParts = sparePartInfoMapper.selectList();
        
        statistics.setOverview(calculateStockOverview(allSpareParts));
        statistics.setAlertStatistics(calculateAlertStatistics(allSpareParts));
        statistics.setCategoryStatistics(calculateCategoryStatistics(allSpareParts));
        statistics.setTrendData(calculateTrendData());
        statistics.setAbcStatistics(calculateABCStatistics(allSpareParts));
        
        return statistics;
    }
}
```

## ğŸ”Œ APIè®¾è®¡

### 6.1 å¤‡ä»¶åŸºç¡€ä¿¡æ¯API
```
GET    /admin-api/coal/spare-part-info/page          # åˆ†é¡µæŸ¥è¯¢
GET    /admin-api/coal/spare-part-info/get           # è·å–è¯¦æƒ…
POST   /admin-api/coal/spare-part-info/create        # æ–°å¢
PUT    /admin-api/coal/spare-part-info/update        # ä¿®æ”¹
DELETE /admin-api/coal/spare-part-info/delete        # åˆ é™¤
GET    /admin-api/coal/spare-part-info/simple-list   # ç®€å•åˆ—è¡¨
GET    /admin-api/coal/spare-part-info/stock-statistics # åº“å­˜ç»Ÿè®¡
```

### 6.2 åº“å­˜ç®¡ç†API
```
GET    /admin-api/coal/spare-part-stock/page         # åˆ†é¡µæŸ¥è¯¢
GET    /admin-api/coal/spare-part-stock/get          # è·å–è¯¦æƒ…
POST   /admin-api/coal/spare-part-stock/create       # æ–°å¢
PUT    /admin-api/coal/spare-part-stock/update       # ä¿®æ”¹
DELETE /admin-api/coal/spare-part-stock/delete       # åˆ é™¤
```

### 6.3 å‡ºå…¥åº“ç®¡ç†API
```
GET    /admin-api/coal/spare-part-inventory-log/page # åˆ†é¡µæŸ¥è¯¢
GET    /admin-api/coal/spare-part-inventory-log/get  # è·å–è¯¦æƒ…
POST   /admin-api/coal/spare-part-inventory-log/create # æ–°å¢
PUT    /admin-api/coal/spare-part-inventory-log/update # ä¿®æ”¹
DELETE /admin-api/coal/spare-part-inventory-log/delete # åˆ é™¤
```

### 6.4 ä½¿ç”¨è®°å½•API
```
GET    /admin-api/coal/spare-part-usage-record/page  # åˆ†é¡µæŸ¥è¯¢
GET    /admin-api/coal/spare-part-usage-record/get   # è·å–è¯¦æƒ…
POST   /admin-api/coal/spare-part-usage-record/create # æ–°å¢
PUT    /admin-api/coal/spare-part-usage-record/update # ä¿®æ”¹
DELETE /admin-api/coal/spare-part-usage-record/delete # åˆ é™¤
```

### 6.5 é¢„è­¦ç®¡ç†API
```
GET    /admin-api/coal/spare-part-alert/page         # åˆ†é¡µæŸ¥è¯¢
GET    /admin-api/coal/spare-part-alert/get          # è·å–è¯¦æƒ…
POST   /admin-api/coal/spare-part-alert/create       # æ–°å¢
PUT    /admin-api/coal/spare-part-alert/update       # ä¿®æ”¹
DELETE /admin-api/coal/spare-part-alert/delete       # åˆ é™¤
```

### 6.6 è®¾å¤‡å…³è”API
```
GET    /admin-api/coal/spare-part-equipment/page     # åˆ†é¡µæŸ¥è¯¢
GET    /admin-api/coal/spare-part-equipment/get      # è·å–è¯¦æƒ…
POST   /admin-api/coal/spare-part-equipment/create   # æ–°å¢
PUT    /admin-api/coal/spare-part-equipment/update   # ä¿®æ”¹
DELETE /admin-api/coal/spare-part-equipment/delete   # åˆ é™¤
```

## ğŸ¨ å‰ç«¯ç•Œé¢

### 7.1 é¡µé¢ç»“æ„
```
å¤‡ä»¶ç®¡ç†/
â”œâ”€â”€ å¤‡ä»¶åˆ†ç±»ç®¡ç†/
â”‚   â”œâ”€â”€ åˆ†ç±»åˆ—è¡¨
â”‚   â””â”€â”€ åˆ†ç±»è¡¨å•
â”œâ”€â”€ å¤‡ä»¶åŸºç¡€ä¿¡æ¯/
â”‚   â”œâ”€â”€ å¤‡ä»¶åˆ—è¡¨
â”‚   â”œâ”€â”€ å¤‡ä»¶è¡¨å•
â”‚   â””â”€â”€ ç»Ÿè®¡åˆ†æ
â”œâ”€â”€ åº“å­˜ç®¡ç†/
â”‚   â”œâ”€â”€ åº“å­˜åˆ—è¡¨
â”‚   â””â”€â”€ åº“å­˜è¡¨å•
â”œâ”€â”€ å‡ºå…¥åº“ç®¡ç†/
â”‚   â”œâ”€â”€ å‡ºå…¥åº“åˆ—è¡¨
â”‚   â””â”€â”€ å‡ºå…¥åº“è¡¨å•
â”œâ”€â”€ ä½¿ç”¨è®°å½•/
â”‚   â”œâ”€â”€ ä½¿ç”¨è®°å½•åˆ—è¡¨
â”‚   â””â”€â”€ ä½¿ç”¨è®°å½•è¡¨å•
â”œâ”€â”€ é¢„è­¦ç®¡ç†/
â”‚   â”œâ”€â”€ é¢„è­¦åˆ—è¡¨
â”‚   â””â”€â”€ é¢„è­¦å¤„ç†
â””â”€â”€ è®¾å¤‡å…³è”/
    â”œâ”€â”€ å…³è”åˆ—è¡¨
    â””â”€â”€ å…³è”è¡¨å•
```

### 7.2 é¦–é¡µç»Ÿè®¡å¡ç‰‡
- **å¤‡ä»¶ç§ç±»**: æ˜¾ç¤ºæ€»å¤‡ä»¶ç±»å‹æ•°é‡
- **æ€»åº“å­˜**: æ˜¾ç¤ºæ€»åº“å­˜æ•°é‡
- **é›¶åº“å­˜**: æ˜¾ç¤ºé›¶åº“å­˜å¤‡ä»¶æ•°é‡
- **ä½åº“å­˜**: æ˜¾ç¤ºä½åº“å­˜å¤‡ä»¶æ•°é‡
- **åº“å­˜å¥åº·åº¦**: æ˜¾ç¤ºåº“å­˜å¥åº·è¯„åˆ†

### 7.3 ç»Ÿè®¡åˆ†æé¡µé¢
- **åº“å­˜æ¦‚è§ˆ**: æ€»ä½“åº“å­˜æƒ…å†µ
- **åˆ†ç±»ç»Ÿè®¡**: æŒ‰åˆ†ç±»ç»Ÿè®¡åº“å­˜
- **è¶‹åŠ¿åˆ†æ**: åº“å­˜å˜åŒ–è¶‹åŠ¿
- **ABCåˆ†æ**: å¤‡ä»¶é‡è¦æ€§åˆ†æ
- **é¢„è­¦ç»Ÿè®¡**: é¢„è­¦æƒ…å†µç»Ÿè®¡

## ğŸ“Š æ•°æ®å­—å…¸

### 8.1 å¤‡ä»¶ç±»å‹ (spare_part_type)
- 1: æœºæ¢°å¤‡ä»¶
- 2: ç”µæ°”å¤‡ä»¶
- 3: æ¶²å‹å¤‡ä»¶
- 4: æ°”åŠ¨å¤‡ä»¶
- 5: å…¶ä»–

### 8.2 æ“ä½œç±»å‹ (operation_type)
- 1: å…¥åº“
- 2: å‡ºåº“

### 8.3 é¢„è­¦ç±»å‹ (alert_type)
- 1: ä½åº“å­˜
- 2: é›¶åº“å­˜
- 3: è¶…é‡åº“å­˜

### 8.4 é¢„è­¦çº§åˆ« (alert_level)
- 1: ä½
- 2: ä¸­
- 3: é«˜

### 8.5 å®¡æ‰¹çŠ¶æ€ (approve_status)
- 0: å¾…å®¡æ‰¹
- 1: å·²å®¡æ‰¹
- 2: å·²æ‹’ç»

### 8.6 æ˜¯å¦å…³é”®å¤‡ä»¶ (is_critical_spare_part)
- 0: å¦
- 1: æ˜¯

### 8.7 æ›´æ¢éš¾åº¦ (replacement_difficulty)
- 1: ç®€å•
- 2: ä¸­ç­‰
- 3: å›°éš¾

### 8.8 ä½¿ç”¨é¢‘ç‡ (usage_frequency)
- 1: ä½
- 2: ä¸­
- 3: é«˜

## ğŸ”§ é…ç½®è¯´æ˜

### 9.1 æ–‡ä»¶ä¸Šä¼ é…ç½®
```yaml
# æ–‡ä»¶ä¸Šä¼ é…ç½®
yudao:
  file:
    base-path: /Users/yunai/file_test
    public-path: /admin-api/infra/file
```

### 9.2 æ•°æ®åº“é…ç½®
```yaml
# æ•°æ®åº“é…ç½®
spring:
  datasource:
    url: jdbc:mysql://127.0.0.1:3306/ruoyi-vue-pro?useUnicode=true&characterEncoding=UTF-8&autoReconnect=true&serverTimezone=Asia/Shanghai&allowPublicKeyRetrieval=true&nullCatalogMeansCurrent=true
    username: root
    password: lijing134
```

### 9.3 ç¼“å­˜é…ç½®
```yaml
# Redisé…ç½®
spring:
  redis:
    host: 127.0.0.1
    port: 6379
    password: 
    database: 1
```

## ğŸ“ å¼€å‘è§„èŒƒ

### 10.1 ä»£ç è§„èŒƒ
- éµå¾ªé˜¿é‡Œå·´å·´Javaå¼€å‘æ‰‹å†Œ
- ä½¿ç”¨ç»Ÿä¸€çš„ä»£ç æ ¼å¼åŒ–é…ç½®
- æ·»åŠ å¿…è¦çš„æ³¨é‡Šå’Œæ–‡æ¡£

### 10.2 æ•°æ®åº“è§„èŒƒ
- è¡¨åä½¿ç”¨ä¸‹åˆ’çº¿å‘½åæ³•
- å­—æ®µåä½¿ç”¨ä¸‹åˆ’çº¿å‘½åæ³•
- å¿…é¡»åŒ…å«åˆ›å»ºæ—¶é—´ã€æ›´æ–°æ—¶é—´ã€åˆ›å»ºè€…ã€æ›´æ–°è€…ã€åˆ é™¤æ ‡è®°ã€ç§Ÿæˆ·ID

### 10.3 APIè§„èŒƒ
- ä½¿ç”¨RESTful APIè®¾è®¡
- ç»Ÿä¸€çš„å“åº”æ ¼å¼
- å®Œå–„çš„é”™è¯¯å¤„ç†

### 10.4 å‰ç«¯è§„èŒƒ
- ä½¿ç”¨TypeScript
- ç»„ä»¶åŒ–å¼€å‘
- ç»Ÿä¸€çš„UIé£æ ¼

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**åˆ›å»ºæ—¶é—´**: 2025-01-09  
**æ›´æ–°æ—¶é—´**: 2025-01-09  
**ç»´æŠ¤äººå‘˜**: å¼€å‘å›¢é˜Ÿ
