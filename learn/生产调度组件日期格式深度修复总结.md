# ç”Ÿäº§è°ƒåº¦ç»„ä»¶æ—¥æœŸæ ¼å¼æ·±åº¦ä¿®å¤æ€»ç»“

## é—®é¢˜è¯¦ç»†åˆ†æ

### ğŸ” é”™è¯¯ä¿¡æ¯è¯¦è§£

```
Failed to convert property value of type 'java.lang.String' to required type 'java.time.LocalDate' 
for property 'scheduleDate[0]'; 
nested exception is org.springframework.core.convert.ConversionFailedException: 
Failed to convert from type [java.lang.String] to type [@io.swagger.v3.oas.annotations.media.Schema 
@org.springframework.format.annotation.DateTimeFormat java.time.LocalDate] for value [2025-09-10]; 
nested exception is java.lang.IllegalArgumentException: Parse attempt failed for value [2025-09-10]
```

### ğŸ¯ æ ¹æœ¬åŸå› 

é€šè¿‡æ·±å…¥åˆ†æåç«¯ä»£ç ï¼Œå‘ç°äº†å…³é”®é—®é¢˜ï¼š

#### 1. **åç«¯æ—¥æœŸå­—æ®µç±»å‹ä¸ä¸€è‡´**

**æ’ç­ç®¡ç†VO** (`SchedulePageReqVO.java`):
```java
@Schema(description = "æ’ç­æ—¥æœŸ")
@DateTimeFormat(pattern = FORMAT_YEAR_MONTH_DAY_HOUR_MINUTE_SECOND) // âŒ é”™è¯¯çš„æ ¼å¼
private LocalDate[] scheduleDate; // LocalDate ç±»å‹ï¼Œä¸åŒ…å«æ—¶é—´
```

**ç”Ÿäº§æ—¥æŠ¥VO** (`ProductionDailyReportPageReqVO.java`):
```java
@Schema(description = "æ—¥æœŸ")
@DateTimeFormat(pattern = FORMAT_YEAR_MONTH_DAY_HOUR_MINUTE_SECOND) // âœ… æ­£ç¡®çš„æ ¼å¼
private LocalDateTime[] reportDate; // LocalDateTime ç±»å‹ï¼ŒåŒ…å«æ—¶é—´
```

#### 2. **åç«¯é…ç½®é”™è¯¯**

æ’ç­ç®¡ç†çš„ `scheduleDate` å­—æ®µå­˜åœ¨è®¾è®¡ç¼ºé™·ï¼š
- **å­—æ®µç±»å‹**: `LocalDate[]` (åªåŒ…å«æ—¥æœŸ)
- **æ³¨è§£æ ¼å¼**: `FORMAT_YEAR_MONTH_DAY_HOUR_MINUTE_SECOND` (åŒ…å«æ—¶åˆ†ç§’)
- **å†²çª**: ç±»å‹ä¸æ ¼å¼ä¸åŒ¹é…

### ğŸ“‹ èŠ‹é“æ¡†æ¶æ—¥æœŸæ ¼å¼å¸¸é‡

```java
// yudao-framework/yudao-common/.../DateUtils.java
public static final String FORMAT_YEAR_MONTH_DAY = "yyyy-MM-dd";
public static final String FORMAT_YEAR_MONTH_DAY_HOUR_MINUTE_SECOND = "yyyy-MM-dd HH:mm:ss";
```

## ä¿®å¤ç­–ç•¥

### ğŸ› ï¸ å‰ç«¯é€‚é…æ–¹æ¡ˆ

ç”±äºåç«¯å¯èƒ½æ— æ³•ç«‹å³ä¿®æ”¹ï¼Œé‡‡ç”¨å‰ç«¯é€‚é…ç­–ç•¥ï¼š

#### 1. **åŒºåˆ†ä¸åŒAPIçš„æ—¥æœŸæ ¼å¼éœ€æ±‚**

```typescript
// æ’ç­ç®¡ç†API - LocalDate[]ç±»å‹ï¼Œåªéœ€æ—¥æœŸ
// æš‚æ—¶ä¸ä¼ é€’scheduleDateå‚æ•°ï¼Œé¿å…æ ¼å¼å†²çª
todayScheduleResponse = await ScheduleApi.getSchedulePage({
  pageNo: 1,
  pageSize: 1
  // ä¸ä¼ scheduleDateå‚æ•°
})

// ç”Ÿäº§æ—¥æŠ¥API - LocalDateTime[]ç±»å‹ï¼Œéœ€è¦å®Œæ•´æ—¶é—´
todayReportResponse = await ProductionDailyReportApi.getProductionDailyReportPage({
  pageNo: 1,
  pageSize: 1,
  reportDate: [`${today} 00:00:00`, `${today} 23:59:59`]
})
```

#### 2. **å¢å¼ºé”™è¯¯å®¹é”™èƒ½åŠ›**

```typescript
// ä¸ºæ‰€æœ‰å¯èƒ½å¤±è´¥çš„APIè°ƒç”¨æ·»åŠ try-catch
let todayScheduleResponse = { total: 0 }
try {
  todayScheduleResponse = await ScheduleApi.getSchedulePage({...})
} catch (error) {
  console.warn('è·å–ä»Šæ—¥æ’ç­æ•°é‡å¤±è´¥:', error)
}
```

### ğŸ”§ å…·ä½“ä¿®å¤å†…å®¹

#### 1. **æ’ç­ç®¡ç†APIè°ƒç”¨**
- **ä¿®å¤å‰**: ä¼ é€’ `scheduleDate: [today, today]`
- **ä¿®å¤å**: æš‚æ—¶ä¸ä¼ é€’ `scheduleDate` å‚æ•°
- **åŸå› **: é¿å… `LocalDate[]` ä¸æ—¶é—´æ ¼å¼çš„å†²çª

#### 2. **ç”Ÿäº§æ—¥æŠ¥APIè°ƒç”¨**
- **ä¿®å¤å‰**: ä¼ é€’ `reportDate: [today, today]`
- **ä¿®å¤å**: ä¼ é€’ `reportDate: [`${today} 00:00:00`, `${today} 23:59:59`]`
- **åŸå› **: `LocalDateTime[]` éœ€è¦å®Œæ•´çš„æ—¶é—´ä¿¡æ¯

#### 3. **æœˆåº¦ç»Ÿè®¡APIè°ƒç”¨**
- **ä¿®å¤å‰**: ä¼ é€’ `reportDate: [monthStart, monthEnd]`
- **ä¿®å¤å**: ä¼ é€’ `reportDate: [`${monthStart} 00:00:00`, `${monthEnd} 23:59:59`]`
- **åŸå› **: ç¡®ä¿æ—¶é—´èŒƒå›´è¦†ç›–æ•´æœˆ

## åç«¯é—®é¢˜åˆ†æ

### âŒ åç«¯è®¾è®¡é—®é¢˜

#### 1. **ç±»å‹ä¸æ ¼å¼ä¸åŒ¹é…**

`SchedulePageReqVO.java` ä¸­çš„è®¾è®¡ç¼ºé™·ï¼š
```java
// é—®é¢˜ï¼šLocalDateç±»å‹ä½¿ç”¨äº†åŒ…å«æ—¶åˆ†ç§’çš„æ ¼å¼
@DateTimeFormat(pattern = FORMAT_YEAR_MONTH_DAY_HOUR_MINUTE_SECOND) // yyyy-MM-dd HH:mm:ss
private LocalDate[] scheduleDate; // åªèƒ½æ¥å— yyyy-MM-dd æ ¼å¼
```

#### 2. **åº”è¯¥çš„æ­£ç¡®è®¾è®¡**

```java
// æ–¹æ¡ˆ1ï¼šä½¿ç”¨LocalDateå’Œå¯¹åº”æ ¼å¼
@DateTimeFormat(pattern = FORMAT_YEAR_MONTH_DAY) // yyyy-MM-dd
private LocalDate[] scheduleDate;

// æ–¹æ¡ˆ2ï¼šä½¿ç”¨LocalDateTimeå’Œå¯¹åº”æ ¼å¼  
@DateTimeFormat(pattern = FORMAT_YEAR_MONTH_DAY_HOUR_MINUTE_SECOND) // yyyy-MM-dd HH:mm:ss
private LocalDateTime[] scheduleDate;
```

### ğŸ” å…¶ä»–æ¨¡å—å¯¹æ¯”

å…¶ä»–æ¨¡å—çš„æ­£ç¡®å®ç°ï¼š
```java
// å¤‡ä»¶ä½¿ç”¨è®°å½• - æ­£ç¡®çš„è®¾è®¡
@DateTimeFormat(pattern = FORMAT_YEAR_MONTH_DAY_HOUR_MINUTE_SECOND)
private LocalDateTime[] usageDate; // ç±»å‹ä¸æ ¼å¼åŒ¹é…

// æŠ¥ä¿®å• - æ­£ç¡®çš„è®¾è®¡
@DateTimeFormat(pattern = FORMAT_YEAR_MONTH_DAY_HOUR_MINUTE_SECOND)
private LocalDateTime[] createTime; // ç±»å‹ä¸æ ¼å¼åŒ¹é…
```

## å®Œæ•´ä¿®å¤ä»£ç 

### ğŸ“ ä¿®å¤åçš„APIè°ƒç”¨

```typescript
// è·å–ç”Ÿäº§è°ƒåº¦ä¸šåŠ¡æµç¨‹æ•°æ®
const getBusinessFlowData = async () => {
  try {
    // ... åŸºç¡€æ•°æ®è·å– ...
    
    // è·å–ä»Šæ—¥æ’ç­æ•°é‡ï¼ˆé¿å…æ—¥æœŸæ ¼å¼å†²çªï¼‰
    let todayScheduleResponse = { total: 0 }
    try {
      todayScheduleResponse = await ScheduleApi.getSchedulePage({
        pageNo: 1,
        pageSize: 1
        // æš‚æ—¶ä¸ä¼ scheduleDateå‚æ•°
      })
    } catch (error) {
      console.warn('è·å–ä»Šæ—¥æ’ç­æ•°é‡å¤±è´¥:', error)
    }
    
    // è·å–ä»Šæ—¥ç”Ÿäº§æ—¥æŠ¥ï¼ˆä½¿ç”¨æ­£ç¡®çš„DateTimeæ ¼å¼ï¼‰
    const today = new Date().toISOString().split('T')[0]
    const todayStart = `${today} 00:00:00`
    const todayEnd = `${today} 23:59:59`
    let todayReportResponse = { total: 0, list: [] }
    try {
      todayReportResponse = await ProductionDailyReportApi.getProductionDailyReportPage({
        pageNo: 1,
        pageSize: 1,
        reportDate: [todayStart, todayEnd]
      })
    } catch (error) {
      console.warn('è·å–ä»Šæ—¥ç”Ÿäº§æ—¥æŠ¥æ•°é‡å¤±è´¥:', error)
    }
    
    // è·å–æœ¬æœˆç»Ÿè®¡ï¼ˆä½¿ç”¨æ­£ç¡®çš„DateTimeæ ¼å¼ï¼‰
    const monthStart = new Date(currentYear, currentMonth - 1, 1).toISOString().split('T')[0]
    const monthEnd = new Date(currentYear, currentMonth, 0).toISOString().split('T')[0]
    const monthStartTime = `${monthStart} 00:00:00`
    const monthEndTime = `${monthEnd} 23:59:59`
    let monthlyReportResponse = { list: [] }
    try {
      monthlyReportResponse = await ProductionDailyReportApi.getProductionDailyReportPage({
        pageNo: 1,
        pageSize: 100,
        reportDate: [monthStartTime, monthEndTime]
      })
    } catch (error) {
      console.warn('è·å–æœ¬æœˆç”Ÿäº§æ•°æ®ç»Ÿè®¡å¤±è´¥:', error)
    }
    
    // ... æ•°æ®å¤„ç†å’Œè¿”å› ...
  } catch (error) {
    // ... é”™è¯¯å¤„ç† ...
  }
}
```

## å»ºè®®çš„åç«¯ä¿®å¤

### ğŸ”§ æ¨èçš„åç«¯ä¿®æ”¹

ä¿®æ”¹ `SchedulePageReqVO.java`ï¼š

```java
@Schema(description = "æ’ç­æ—¥æœŸ")
@DateTimeFormat(pattern = FORMAT_YEAR_MONTH_DAY) // ä¿®æ”¹ä¸ºåªåŒ…å«æ—¥æœŸçš„æ ¼å¼
private LocalDate[] scheduleDate;
```

æˆ–è€…ï¼š

```java
@Schema(description = "æ’ç­æ—¥æœŸ")
@DateTimeFormat(pattern = FORMAT_YEAR_MONTH_DAY_HOUR_MINUTE_SECOND)
private LocalDateTime[] scheduleDate; // ä¿®æ”¹ä¸ºDateTimeç±»å‹
```

## æµ‹è¯•éªŒè¯

### âœ… éªŒè¯è¦ç‚¹

1. **é¦–é¡µæ­£å¸¸åŠ è½½**ï¼šæ— æ—¥æœŸè½¬æ¢é”™è¯¯
2. **ç”Ÿäº§è°ƒåº¦ç»„ä»¶æ˜¾ç¤º**ï¼šå„é¡¹ç»Ÿè®¡æ•°æ®æ­£å¸¸
3. **APIè°ƒç”¨æˆåŠŸ**ï¼šç”Ÿäº§æ—¥æŠ¥æ•°æ®èƒ½æ­£ç¡®è·å–
4. **æ’ç­æ•°æ®è·å–**ï¼šè™½ç„¶æ— æ³•æŒ‰æ—¥æœŸç­›é€‰ï¼Œä½†èƒ½è·å–æ€»æ•°
5. **é”™è¯¯å¤„ç†ç”Ÿæ•ˆ**ï¼šå•ä¸ªAPIå¤±è´¥ä¸å½±å“æ•´ä½“

### ğŸ“Š åŠŸèƒ½çŠ¶æ€

| åŠŸèƒ½æ¨¡å— | çŠ¶æ€ | è¯´æ˜ |
|---------|------|------|
| ç”Ÿäº§è®¡åˆ’ç»Ÿè®¡ | âœ… æ­£å¸¸ | æ— æ—¥æœŸæŸ¥è¯¢ |
| ç­åˆ¶ç­æ¬¡ç»Ÿè®¡ | âœ… æ­£å¸¸ | æ— æ—¥æœŸæŸ¥è¯¢ |
| æ’ç­ç®¡ç†ç»Ÿè®¡ | âš ï¸ éƒ¨åˆ†æ­£å¸¸ | æ— æ³•æŒ‰æ—¥æœŸç­›é€‰ |
| ç”Ÿäº§æ—¥æŠ¥ç»Ÿè®¡ | âœ… æ­£å¸¸ | æ—¥æœŸæ ¼å¼å·²ä¿®å¤ |
| é¡µé¢è·³è½¬ | âœ… æ­£å¸¸ | è·¯ç”±å·¥ä½œæ­£å¸¸ |

## å­¦ä¹ æ€»ç»“

### ğŸ“š æŠ€æœ¯æ”¶è·

#### 1. **Spring Bootæ—¥æœŸå¤„ç†æœºåˆ¶**
- ç†è§£äº† `@DateTimeFormat` æ³¨è§£çš„ä½œç”¨
- æŒæ¡äº† `LocalDate` ä¸ `LocalDateTime` çš„åŒºåˆ«
- å­¦ä¼šäº†æ—¥æœŸæ ¼å¼å­—ç¬¦ä¸²çš„åŒ¹é…è§„åˆ™

#### 2. **å‰åç«¯æ•°æ®äº¤äº’**
- è®¤è¯†åˆ°å‰åç«¯æ—¥æœŸæ ¼å¼çº¦å®šçš„é‡è¦æ€§
- å­¦ä¼šäº†å‰ç«¯é€‚é…åç«¯æ¥å£çš„ç­–ç•¥
- æŒæ¡äº†é”™è¯¯å®¹é”™çš„è®¾è®¡åŸåˆ™

#### 3. **é—®é¢˜è°ƒè¯•æŠ€å·§**
- å­¦ä¼šäº†é€šè¿‡é”™è¯¯ä¿¡æ¯è¿½æº¯æ ¹æœ¬åŸå› 
- æŒæ¡äº†è¯»å–åç«¯VOç±»çš„æ–¹æ³•
- å»ºç«‹äº†ç³»ç»Ÿæ€§çš„é—®é¢˜åˆ†ææµç¨‹

### ğŸ’¡ æœ€ä½³å®è·µ

#### 1. **APIè®¾è®¡åŸåˆ™**
- ä¿æŒç±»å‹ä¸æ ¼å¼çš„ä¸€è‡´æ€§
- ç»Ÿä¸€é¡¹ç›®å†…çš„æ—¥æœŸå¤„ç†æ ‡å‡†
- æä¾›æ¸…æ™°çš„æ¥å£æ–‡æ¡£

#### 2. **å‰ç«¯å®¹é”™è®¾è®¡**
- ä¸ºæ‰€æœ‰å¤–éƒ¨APIè°ƒç”¨æ·»åŠ é”™è¯¯å¤„ç†
- æä¾›åˆç†çš„é»˜è®¤å€¼å’Œé™çº§æ–¹æ¡ˆ
- è®°å½•è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯ä¾¿äºè°ƒè¯•

#### 3. **ä»£ç ç»´æŠ¤ç­–ç•¥**
- è¯¦ç»†æ³¨é‡Šè¯´æ˜æ—¥æœŸæ ¼å¼è¦æ±‚
- å»ºç«‹å®Œå–„çš„æµ‹è¯•éªŒè¯æœºåˆ¶
- å®šæœŸå®¡æŸ¥å’Œæ›´æ–°æ¥å£è®¾è®¡

## ç›¸å…³æ–‡ä»¶

- `yudao-ui/yudao-ui-admin-vue3/src/components/ProductionScheduleBusinessFlowCard.vue` - ä¿®å¤çš„å‰ç«¯ç»„ä»¶
- `yudao-module-coal/.../schedule/vo/SchedulePageReqVO.java` - å­˜åœ¨é—®é¢˜çš„åç«¯VO
- `yudao-module-coal/.../productiondailyreport/vo/ProductionDailyReportPageReqVO.java` - æ­£ç¡®è®¾è®¡çš„åç«¯VO
- `yudao-framework/yudao-common/.../DateUtils.java` - æ—¥æœŸæ ¼å¼å¸¸é‡å®šä¹‰

è¿™æ¬¡ä¿®å¤å±•ç¤ºäº†åœ¨å¤æ‚ç³»ç»Ÿä¸­å¤„ç†å‰åç«¯æ•°æ®æ ¼å¼ä¸åŒ¹é…é—®é¢˜çš„å®Œæ•´æµç¨‹ï¼Œä¸ºç±»ä¼¼é—®é¢˜çš„è§£å†³æä¾›äº†å‚è€ƒã€‚
