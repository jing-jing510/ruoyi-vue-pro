# 煤质管理模块业务流程图

## 🔄 整体业务流程图

```
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   基础数据准备   │    │   检测执行阶段   │    │   审核确认阶段   │
│                │    │                │    │                │
│ 1.维护检测项目  │───▶│ 4.创建检测记录  │───▶│ 7.接收审核任务  │
│ 2.制定质量标准  │    │ 5.录入检测数据  │    │ 8.检查检测数据  │
│ 3.标准审批     │    │ 6.自动计算判断  │    │ 9.审核决策     │
└─────────────────┘    └─────────────────┘    └─────────────────┘
         │                       │                       │
         ▼                       ▼                       ▼
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   预警处理阶段   │    │   数据存储      │    │   报表分析      │
│                │    │                │    │                │
│10.预警条件检查  │    │13.检测记录存储  │    │16.质量趋势分析  │
│11.生成预警记录  │    │14.检测数据存储  │    │17.合格率统计    │
│12.处理预警     │    │15.预警记录存储  │    │18.异常分析      │
└─────────────────┘    └─────────────────┘    └─────────────────┘
```

## 📋 详细业务流程

### 阶段一：基础数据准备
```
检测项目管理
    ↓
质量标准制定
    ↓
标准审批流程
    ↓
标准发布生效
```

### 阶段二：检测执行
```
创建检测记录
    ↓
选择检测项目
    ↓
录入检测数据
    ↓
系统自动计算
    ↓
判断是否合格
    ↓
[不合格] → 复检处理 → 重新录入
    ↓
[合格] → 提交审核
```

### 阶段三：审核确认
```
接收审核任务
    ↓
检查检测数据
    ↓
[数据准确] → 审核通过 → 记录生效
    ↓
[数据异常] → 退回修改 → 重新检测
```

### 阶段四：预警处理
```
预警条件检查
    ↓
[触发预警] → 生成预警记录
    ↓
[正常] → 流程结束
    ↓
分配处理人员
    ↓
执行处理措施
    ↓
记录处理结果
    ↓
预警处理完成
```

## 🔗 数据关联关系

```
coal_quality_item (检测项目)
    ↓ (一对多)
coal_quality_standard (质量标准)
    ↓ (一对多)
coal_quality_inspection (检测记录)
    ↓ (一对多)
coal_quality_data (检测数据)
    ↓ (一对多)
coal_quality_alert (预警记录)
```

## 📊 状态流转图

### 质量标准状态流转
```
草稿 → 启用 → 停用 → 归档
  ↑      ↓
  └──────┘
```

### 检测记录状态流转
```
待检测 → 检测中 → 已完成 → 已审核
   ↑        ↓        ↓
   └────────┴────────┘
```

### 预警记录状态流转
```
待处理 → 处理中 → 已处理
   ↓        ↓        ↓
已忽略 ←─────────────┘
```

## 🎯 关键业务节点

### 1. 数据录入节点
- **输入**：检测数值、环境信息
- **处理**：自动计算偏差值、偏差率
- **输出**：完整的检测数据

### 2. 合格性判断节点
- **输入**：检测值、标准值
- **处理**：比较检测值与标准值范围
- **输出**：合格/不合格判断

### 3. 预警触发节点
- **输入**：检测值、预警阈值
- **处理**：检查是否超出预警范围
- **输出**：预警记录生成

### 4. 审核决策节点
- **输入**：检测数据、审核标准
- **处理**：人工审核判断
- **输出**：审核通过/退回

## 🔄 异常处理流程

### 检测数据异常
```
数据异常发现
    ↓
暂停检测流程
    ↓
分析异常原因
    ↓
[设备问题] → 联系设备维修
    ↓
[操作问题] → 重新培训操作
    ↓
[环境问题] → 改善检测环境
    ↓
重新检测
```

### 预警处理异常
```
预警处理超时
    ↓
升级预警级别
    ↓
通知上级管理人员
    ↓
强制处理措施
    ↓
记录处理结果
```

## 📈 业务监控指标

### 1. 检测效率指标
- 检测完成率
- 检测及时率
- 复检率

### 2. 质量指标
- 产品合格率
- 质量稳定性
- 异常检出率

### 3. 预警指标
- 预警触发率
- 预警处理及时率
- 预警处理成功率

### 4. 审核指标
- 审核通过率
- 审核及时率
- 数据退回率

---

*此流程图展示了煤质管理模块的完整业务流程，帮助理解各环节的关联关系和处理逻辑。*
