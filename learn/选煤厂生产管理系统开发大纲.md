# 选煤厂生产管理系统开发大纲

## 🎯 项目概述

基于芋道开源框架开发的选煤厂智能生产管控系统，实现生产调度、设备管理、煤质管理、安全管理等全流程数字化管理。系统采用标准数据库设计，数据标准指导后续各种选煤智能化新技术开发，确保选煤信息"一次输入，全局共享"，提高数据的真实性和唯一性。

### 📋 开发进度跟踪

**已完成模块：**
- ✅ **生产计划管理** - 树表结构，支持年/月/日/班计划层级管理
- ✅ **生产日报管理** - 现场生产数据记录，包含产量、质量、设备状态等
- ✅ **班制与班次设置** - 树表结构，支持多种班制模式和灵活班次配置
- ✅ **排班管理** - 主子表结构，支持日常排班、人员安排和替班管理（已完成开发和字典优化）

**推荐下一个开发模块：**
- 🎯 **设备档案管理** - 设备台账、设备档案、二维码管理（推荐优先开发）

**待开发模块：**
- ⏳ **备件管理** - 备件库存、出入库管理、预警机制
- ⏳ **检修管理** - 检修计划、检修单、报修单管理
- ⏳ **煤质管理** - 煤质检测、质量分析、指标统计  
- ⏳ **安全管理** - 安全检查、隐患排查、事故管理
- ⏳ **能源管理** - 用电、用水、介质消耗统计
- ⏳ **调度看板** - 生产看板、任务看板、报警看板
- ⏳ **报表统计** - 各类生产报表和数据分析

### 技术架构
- **后端**：Spring Boot + MyBatis-Plus + SQL Server
- **前端**：Vue 3 + TypeScript + Element Plus
- **框架**：芋道开源框架 (ruoyi-vue-pro)
- **数据库**：MySQL 8.0+（支持JSON数据类型，存储半结构化数据）
- **部署**：Docker + Nginx
- **集成**：PLC数据采集、OPC UA、MQTT协议支持

---

## 📊 系统架构设计

### 模块划分

```
yudao-module-coal/                    # 选煤厂核心模块
├── production/                       # 生产调度管理
├── equipment/                        # 设备档案管理  
├── quality/                          # 煤质管理
├── safety/                          # 安全管理
├── energy/                          # 能源管理
├── report/                          # 报表统计
└── common/                          # 公共组件
```

### 数据库设计原则
- 采用 MySQL 8.0+ 数据库，支持JSON数据类型存储半结构化数据
- 遵循第三范式设计，确保数据标准化
- 支持多租户架构，数据隔离安全
- 预留扩展字段，支持后续功能扩展
- 建立完整的索引体系，优化查询性能
- 数据标准统一，支持"一次输入，全局共享"

---

## 🗄️ 数据库设计详解

### 1. 生产调度管理模块

#### 1.1 生产计划表 (coal_production_plan) - 树表结构
```sql
DROP TABLE IF EXISTS `coal_production_plan`;
CREATE TABLE `coal_production_plan` (
    `id` BIGINT NOT NULL AUTO_INCREMENT COMMENT '计划ID',
    `name` VARCHAR(100) NOT NULL COMMENT '计划名称',
    `parent_id` BIGINT NOT NULL DEFAULT 0 COMMENT '父计划ID',
    `sort` INT NOT NULL DEFAULT 0 COMMENT '显示顺序',
    `plan_code` VARCHAR(50) NOT NULL DEFAULT '' COMMENT '计划编号',
    `plan_type` TINYINT NOT NULL COMMENT '计划类型：1年度 2月度 3日计划 4班计划',
    `plan_year` INT NULL COMMENT '计划年度',
    `plan_month` TINYINT NULL COMMENT '计划月份',
    `plan_date` DATE NULL COMMENT '计划日期',
    `shift_id` BIGINT NULL COMMENT '班次ID',
    `status` TINYINT NOT NULL DEFAULT 1 COMMENT '计划状态：0停用 1正常',
    plan_path VARCHAR(500) COMMENT '计划层级路径（如：1/2/3表示年/月/日）',

    -- 计划产量数据（基础）
    `raw_coal_plan` DECIMAL(10,2) NULL COMMENT '计划入洗原煤量(吨)',

    -- 精煤产量计划（按粒度分类）
    `fine_coal_plan` DECIMAL(10,2) NULL COMMENT '计划末煤产量(吨)',
    `granular_coal_plan` DECIMAL(10,2) NULL COMMENT '计划粒煤产量(吨)',
    `large_block_coal_plan` DECIMAL(10,2) NULL COMMENT '计划大块煤产量(吨)',
    `medium_block_coal_plan` DECIMAL(10,2) NULL COMMENT '计划中块煤产量(吨)',
    `small_block_coal_plan` DECIMAL(10,2) NULL COMMENT '计划小块煤产量(吨)',

    -- 其他产品计划产量
    `middling_coal_plan` DECIMAL(10,2) NULL COMMENT '计划中煤产量(吨)',
    `slime_plan` DECIMAL(10,2) NULL COMMENT '计划煤泥产量(吨)',
    `gangue_plan` DECIMAL(10,2) NULL COMMENT '计划矸石产量(吨)',

    -- 预留计划产量字段
    `reserved_product_plan1` DECIMAL(10,2) NULL COMMENT '预留计划产量字段1(吨)',
    `reserved_product_plan2` DECIMAL(10,2) NULL COMMENT '预留计划产量字段2(吨)',

    -- 质量指标
    `fine_coal_ash` DECIMAL(5,2) NULL COMMENT '末煤灰分(%)',
    `granular_coal_ash` DECIMAL(5,2) NULL COMMENT '粒煤灰分(%)',
    `large_block_coal_ash` DECIMAL(5,2) NULL COMMENT '大块煤灰分(%)',
    `medium_block_coal_ash` DECIMAL(5,2) NULL COMMENT '中块煤灰分(%)',
    `small_block_coal_ash` DECIMAL(5,2) NULL COMMENT '小块煤灰分(%)',
    `middling_coal_ash` DECIMAL(5,2) NULL COMMENT '中煤灰分(%)',

    -- 审批信息
    `creator_id` BIGINT NULL COMMENT '制定人ID',
    `approver_id` BIGINT NULL COMMENT '审批人ID',
    `approve_time` DATETIME NULL COMMENT '审批时间',

    -- 基础字段（芋道框架标准）
    `creator` VARCHAR(64) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NULL DEFAULT '' COMMENT '创建者',
    `create_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    `updater` VARCHAR(64) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NULL DEFAULT '' COMMENT '更新者',
    `update_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    `deleted` BIT(1) NOT NULL DEFAULT b'0' COMMENT '是否删除',
    `tenant_id` BIGINT NOT NULL DEFAULT 0 COMMENT '租户编号',
    PRIMARY KEY (`id`) USING BTREE
) ENGINE = InnoDB AUTO_INCREMENT = 1 CHARACTER SET = utf8mb4 COLLATE = utf8mb4_unicode_ci COMMENT = '生产计划表（树表结构）';
```

#### 1.2 现场生产日报表 (coal_production_daily_report)
```sql
CREATE TABLE `coal_production_daily_report` (
  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '日报id',
  `report_date` datetime NOT NULL COMMENT '日期',
  `shift_id` bigint DEFAULT NULL COMMENT '班次ID',
  `operator_id` bigint DEFAULT NULL COMMENT '集控员（操作人）ID',
  `shift_leader_id` bigint DEFAULT NULL COMMENT '带班主任/班长ID',
  `start_time` datetime DEFAULT NULL COMMENT '启车时间',
  `coal_feeding_time` int DEFAULT NULL COMMENT '带煤时间(分钟)',
  `stop_time` datetime DEFAULT NULL COMMENT '停车时间',
  `effective_feeding_time` int DEFAULT NULL COMMENT '有效带煤时间(分钟)',
  `fault_impact_time` int DEFAULT NULL COMMENT '故障影响时间(分钟)',
  `raw_coal_input` decimal(10,2) DEFAULT NULL COMMENT '入洗煤量(吨)',
  `hourly_capacity` decimal(8,2) DEFAULT NULL COMMENT '小时处理量(吨/小时)',
  `block_clean_coal_output` decimal(10,2) DEFAULT NULL COMMENT '块精煤产量(吨)',
  `fine_clean_coal_output` decimal(10,2) DEFAULT NULL COMMENT '末精煤产量(吨)',
  `gangue_output` decimal(10,2) DEFAULT NULL COMMENT '矸石产量(吨)',
  `middling_coal_output` decimal(10,2) DEFAULT NULL COMMENT '中煤产量(吨)',
  `filter_press_cycles` int DEFAULT NULL COMMENT '压滤板次',
  `filter_press_coal_amount` decimal(8,2) DEFAULT NULL COMMENT '压滤煤量(吨)',
  `filter_cloth_usage` int DEFAULT NULL COMMENT '滤布使用量(张)',
  `discharge_record` varchar(500) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT '放舱记录',
  `baffle_medium_addition` decimal(8,2) DEFAULT NULL COMMENT '挡板添加介质量(kg)',
  `cao_amount` decimal(8,2) DEFAULT NULL COMMENT 'CaO量(kg)',
  `flocculant_amount` decimal(8,2) DEFAULT NULL COMMENT '絮凝剂(kg)',
  `density_MD317` decimal(5,2) DEFAULT NULL COMMENT '317密度(kg/L)',
  `first_ash_block_clean` decimal(5,2) DEFAULT NULL COMMENT '第一次块精煤灰分(%)',
  `first_ash_fine_clean` decimal(5,2) DEFAULT NULL COMMENT '第一次末精煤灰分(%)',
  `first_ash_middling` decimal(5,2) DEFAULT NULL COMMENT '第一次中煤灰分(%)',
  `first_ash_slime` decimal(5,2) DEFAULT NULL COMMENT '第一次煤泥灰分(%)',
  `first_ash_gangue` decimal(5,2) DEFAULT NULL COMMENT '第一次矸石灰分(%)',
  `second_ash_block_clean` decimal(5,2) DEFAULT NULL COMMENT '第二次块精煤灰分(%)',
  `second_ash_fine_clean` decimal(5,2) DEFAULT NULL COMMENT '第二次末精煤灰分(%)',
  `second_ash_middling` decimal(5,2) DEFAULT NULL COMMENT '第二次中煤灰分(%)',
  `second_ash_slime` decimal(5,2) DEFAULT NULL COMMENT '第二次煤泥灰分(%)',
  `second_ash_gangue` decimal(5,2) DEFAULT NULL COMMENT '第二次矸石灰分(%)',
  `impact_time_record` text COLLATE utf8mb4_unicode_ci COMMENT '影响时间记录详情',
  `assigned_tasks` text COLLATE utf8mb4_unicode_ci COMMENT '交办事项',
  `start_circulating_water_pool` decimal(6,2) DEFAULT NULL COMMENT '启车循环水池液位',
  `start_clean_water_tank` decimal(6,2) DEFAULT NULL COMMENT '启车清水桶液位',
  `start_fine_coal_level` decimal(6,2) DEFAULT NULL COMMENT '启车末煤仓位',
  `start_granular_coal_level` decimal(6,2) DEFAULT NULL COMMENT '启车粒煤仓位',
  `start_large_block_level` decimal(6,2) DEFAULT NULL COMMENT '启车大块仓位',
  `start_medium_block_level` decimal(6,2) DEFAULT NULL COMMENT '启车中块仓位',
  `start_small_block_level` decimal(6,2) DEFAULT NULL COMMENT '启车小块仓位',
  `start_middling_coal_level` decimal(6,2) DEFAULT NULL COMMENT '启车中煤仓位',
  `start_gangue_level` decimal(6,2) DEFAULT NULL COMMENT '启车矸石仓位',
  `stop_circulating_water_pool` decimal(6,2) DEFAULT NULL COMMENT '停车循环水池液位',
  `stop_clean_water_tank` decimal(6,2) DEFAULT NULL COMMENT '停车清水桶液位',
  `stop_fine_coal_level` decimal(6,2) DEFAULT NULL COMMENT '停车末煤仓位',
  `stop_granular_coal_level` decimal(6,2) DEFAULT NULL COMMENT '停车粒煤仓位',
  `stop_large_block_level` decimal(6,2) DEFAULT NULL COMMENT '停车大块仓位',
  `stop_medium_block_level` decimal(6,2) DEFAULT NULL COMMENT '停车中块仓位',
  `stop_small_block_level` decimal(6,2) DEFAULT NULL COMMENT '停车小块仓位',
  `stop_middling_coal_level` decimal(6,2) DEFAULT NULL COMMENT '停车中煤仓位',
  `stop_gangue_level` decimal(6,2) DEFAULT NULL COMMENT '停车矸石仓位',
  `remarks` text COLLATE utf8mb4_unicode_ci COMMENT '备注信息',
  `reserved_field1` varchar(200) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT '预留字段1',
  `reserved_field2` varchar(200) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT '预留字段2',
  `reserved_field3` decimal(10,2) DEFAULT NULL COMMENT '预留字段3',
  `reserved_field4` decimal(10,2) DEFAULT NULL COMMENT '预留字段4',
  `reserved_field5` text COLLATE utf8mb4_unicode_ci COMMENT '预留字段5',
  `creator` varchar(64) COLLATE utf8mb4_unicode_ci DEFAULT '' COMMENT '创建者',
  `create_time` datetime DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
  `updater` varchar(64) COLLATE utf8mb4_unicode_ci DEFAULT '' COMMENT '更新者',
  `update_time` datetime DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
  `deleted` tinyint DEFAULT '0' COMMENT '是否删除',
  `tenant_id` bigint DEFAULT '0' COMMENT '租户ID',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=1120870174271299585 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='现场生产日报表';
```

#### 1.3 计划完成率统计表 (coal_plan_completion_statistics)
```sql
CREATE TABLE coal_plan_completion_statistics (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    plan_id BIGINT NOT NULL COMMENT '计划ID',
    statistics_date DATE NOT NULL COMMENT '统计日期',
    statistics_type TINYINT NOT NULL COMMENT '统计类型：1日统计 2月统计 3年统计 4班统计',

    -- 计划数据
    plan_raw_coal DECIMAL(10,2),                  -- 计划入洗原煤量(吨)
    plan_fine_coal DECIMAL(10,2),                 -- 计划末煤产量(吨)
    plan_granular_coal DECIMAL(10,2),             -- 计划粒煤产量(吨)
    plan_large_block_coal DECIMAL(10,2),          -- 计划大块煤产量(吨)
    plan_medium_block_coal DECIMAL(10,2),         -- 计划中块煤产量(吨)
    plan_small_block_coal DECIMAL(10,2),          -- 计划小块煤产量(吨)
    plan_middling_coal DECIMAL(10,2),             -- 计划中煤产量(吨)
    plan_gangue DECIMAL(10,2),                    -- 计划矸石产量(吨)

    -- 实际完成数据
    actual_raw_coal DECIMAL(10,2),                -- 实际入洗原煤量(吨)
    actual_fine_coal DECIMAL(10,2),               -- 实际末煤产量(吨)
    actual_granular_coal DECIMAL(10,2),           -- 实际粒煤产量(吨)
    actual_large_block_coal DECIMAL(10,2),        -- 实际大块煤产量(吨)
    actual_medium_block_coal DECIMAL(10,2),       -- 实际中块煤产量(吨)
    actual_small_block_coal DECIMAL(10,2),        -- 实际小块煤产量(吨)
    actual_middling_coal DECIMAL(10,2),           -- 实际中煤产量(吨)
    actual_gangue DECIMAL(10,2),                  -- 实际矸石产量(吨)

    -- 完成率数据（百分比）
    completion_rate_raw_coal DECIMAL(5,2),        -- 入洗原煤完成率(%)
    completion_rate_fine_coal DECIMAL(5,2),       -- 末煤完成率(%)
    completion_rate_granular_coal DECIMAL(5,2),   -- 粒煤完成率(%)
    completion_rate_large_block DECIMAL(5,2),     -- 大块煤完成率(%)
    completion_rate_medium_block DECIMAL(5,2),    -- 中块煤完成率(%)
    completion_rate_small_block DECIMAL(5,2),     -- 小块煤完成率(%)
    completion_rate_middling_coal DECIMAL(5,2),   -- 中煤完成率(%)
    completion_rate_gangue DECIMAL(5,2),          -- 矸石完成率(%)

    -- 总体完成率
    overall_completion_rate DECIMAL(5,2),         -- 总体完成率(%)

    -- 统计状态
    statistics_status TINYINT DEFAULT 1,          -- 统计状态：1正常 2异常 3需关注

    -- 基础字段
    creator NVARCHAR(64) DEFAULT '',
    create_time DATETIME DEFAULT GETDATE(),
    updater NVARCHAR(64) DEFAULT '',
    update_time DATETIME DEFAULT GETDATE(),
    deleted BIT DEFAULT 0,
    tenant_id BIGINT DEFAULT 0
);
```

#### 1.4 班次管理模块 (树表 + 主子表)

##### 1.4.1 业务逻辑与表结构设计
为满足合同中"开放性班次设置"、"倒班/值班设置"及"指定生产班"的灵活要求，采用 **树表 + 主子表** 结合的方案：

1.  **班制与班次设置 (`coal_shift_system` - 树表)**:
    *   **作用**: 定义班次的"制度"或"模式"。树结构能清晰体现"班制" (如: 三班两倒) 与其下的具体"班次" (如: 早班, 中班) 的层级关系。
    *   **生成方式**: 使用芋道代码生成器的 **树表** 模板。

2.  **排班管理 (`coal_schedule` - 主表) & 人员安排 (`coal_schedule_staff` - 子表)**:
    *   **作用**: 负责具体的"排班管理"和"人员分配"。主表核心是"哪一天，采用哪种班制"，子表负责"在该天的具体班次中，安排了哪些人"。
    *   **生成方式**: 使用芋道代码生成器的 **主子表** 模板。

**表关系：**
```
coal_shift_system (班制与班次) <--- coal_schedule (排班管理)
                                      |
                                      +--- coal_schedule_staff (人员安排)
```

##### 1.4.2 班制与班次设置 (coal_shift_system) - 树表
```sql
DROP TABLE IF EXISTS `coal_shift_system`;
CREATE TABLE `coal_shift_system` (
    `id` BIGINT NOT NULL AUTO_INCREMENT COMMENT 'ID',
    `parent_id` BIGINT NOT NULL DEFAULT 0 COMMENT '父ID (0=班制, >0=班次)',
    `name` VARCHAR(50) NOT NULL COMMENT '名称 (班制或班次名)',
    `code` VARCHAR(20) NULL COMMENT '编码 (班次编码)',
    `is_production` TINYINT(1) NOT NULL DEFAULT 0 COMMENT '是否生产班制 (仅班制层级有效)',
    `start_time` TIME NULL COMMENT '开始时间 (仅班次层级有效) - 格式：HH:mm:ss',
    `end_time` TIME NULL COMMENT '结束时间 (仅班次层级有效) - 格式：HH:mm:ss',
    `shift_type` TINYINT NULL COMMENT '班次类型：1生产班 2检修班 3值班 (仅班次层级有效)',
    `sort` INT NOT NULL DEFAULT 0 COMMENT '排序',
    `status` TINYINT NOT NULL DEFAULT 1 COMMENT '状态：0禁用 1启用',
    `creator` VARCHAR(64) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NULL DEFAULT '' COMMENT '创建者',
    `create_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    `updater` VARCHAR(64) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NULL DEFAULT '' COMMENT '更新者',
    `update_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    `deleted` BIT(1) NOT NULL DEFAULT b'0' COMMENT '是否删除',
    `tenant_id` BIGINT NOT NULL DEFAULT 0 COMMENT '租户编号',
    PRIMARY KEY (`id`) USING BTREE,
    INDEX `idx_parent_id` (`parent_id`) USING BTREE
) ENGINE = InnoDB AUTO_INCREMENT = 1 CHARACTER SET = utf8mb4 COLLATE = utf8mb4_unicode_ci COMMENT = '班制与班次设置 (树表)';
```

**前端时间选择器配置说明：**
- 使用 `el-time-picker` 组件选择时分秒
- 配置 `value-format="HH:mm:ss"` 确保数据格式为时分秒
- 参考芋道框架中的秒杀配置模块实现方式

##### 1.4.3 排班管理 (coal_schedule) - 主表
```sql
DROP TABLE IF EXISTS `coal_schedule`;
CREATE TABLE `coal_schedule` (
    `id` BIGINT NOT NULL AUTO_INCREMENT COMMENT '排班ID',
    `schedule_date` DATE NOT NULL COMMENT '排班日期',
    `shift_system_id` BIGINT NOT NULL COMMENT '班制ID (关联coal_shift_system)',
    `schedule_status` TINYINT NOT NULL DEFAULT 1 COMMENT '排班状态：1正常 2调整 3取消',
    `is_production_day` TINYINT(1) NOT NULL DEFAULT 1 COMMENT '是否生产日：1是 0否',
    `production_target` DECIMAL(10,2) NULL COMMENT '当日生产目标(吨)',
    `schedule_type` TINYINT NOT NULL DEFAULT 1 COMMENT '排班类型：1正常排班 2节假日排班 3应急排班',
    `approver_id` BIGINT NULL COMMENT '审批人ID',
    `approve_time` DATETIME NULL COMMENT '审批时间',
    `remark` VARCHAR(500) NULL COMMENT '备注',
    `creator` VARCHAR(64) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NULL DEFAULT '' COMMENT '创建者',
    `create_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    `updater` VARCHAR(64) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NULL DEFAULT '' COMMENT '更新者',
    `update_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    `deleted` BIT(1) NOT NULL DEFAULT b'0' COMMENT '是否删除',
    `tenant_id` BIGINT NOT NULL DEFAULT 0 COMMENT '租户编号',
    PRIMARY KEY (`id`) USING BTREE,
    UNIQUE KEY `uk_date` (`schedule_date`, `deleted`) USING BTREE,
    INDEX `idx_shift_system` (`shift_system_id`) USING BTREE,
    INDEX `idx_schedule_date` (`schedule_date`) USING BTREE
) ENGINE = InnoDB AUTO_INCREMENT = 1 CHARACTER SET = utf8mb4 COLLATE = utf8mb4_unicode_ci COMMENT = '排班管理 (主表)';
```

##### 1.4.4 人员安排 (coal_schedule_staff) - 子表
```sql
DROP TABLE IF EXISTS `coal_schedule_staff`;
CREATE TABLE `coal_schedule_staff` (
    `id` BIGINT NOT NULL AUTO_INCREMENT COMMENT '人员安排ID',
    `schedule_id` BIGINT NOT NULL COMMENT '排班ID (关联主表)',
    `shift_id` BIGINT NOT NULL COMMENT '班次ID (关联coal_shift_system的子节点)',
    `user_id` BIGINT NOT NULL COMMENT '员工ID',
    `position_type` TINYINT NOT NULL COMMENT '岗位类型：1调度员 2操作工 3检修工 4安全员 5质检员',
    `is_leader` TINYINT(1) NOT NULL DEFAULT 0 COMMENT '是否班组长',
    `is_substitute` TINYINT(1) NOT NULL DEFAULT 0 COMMENT '是否替班：1是 0否',
    `substitute_reason` VARCHAR(200) NULL COMMENT '替班原因',
    `work_status` TINYINT NOT NULL DEFAULT 1 COMMENT '工作状态：1正常 2请假 3调休 4替班',
    `contact_phone` VARCHAR(20) NULL COMMENT '联系电话',
    `emergency_contact` VARCHAR(50) NULL COMMENT '紧急联系人',
    `emergency_phone` VARCHAR(20) NULL COMMENT '紧急联系电话',
    `creator` VARCHAR(64) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NULL DEFAULT '' COMMENT '创建者',
    `create_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    `updater` VARCHAR(64) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NULL DEFAULT '' COMMENT '更新者',
    `update_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    `deleted` BIT(1) NOT NULL DEFAULT b'0' COMMENT '是否删除',
    `tenant_id` BIGINT NOT NULL DEFAULT 0 COMMENT '租户编号',
    PRIMARY KEY (`id`) USING BTREE,
    INDEX `idx_schedule` (`schedule_id`) USING BTREE,
    INDEX `idx_shift` (`shift_id`) USING BTREE,
    INDEX `idx_user` (`user_id`) USING BTREE,
    INDEX `idx_position` (`position_type`) USING BTREE
) ENGINE = InnoDB AUTO_INCREMENT = 1 CHARACTER SET = utf8mb4 COLLATE = utf8mb4_unicode_ci COMMENT = '人员安排 (子表)';
```

##### 1.4.5 字典数据配置

```sql
-- 班次类型字典
INSERT INTO `system_dict_type` (`name`, `type`, `status`, `remark`, `creator`, `create_time`, `updater`, `update_time`, `deleted`) VALUES 
('班次类型', 'shift_type', 0, '班次类型', '1', NOW(), '1', NOW(), 0);

INSERT INTO `system_dict_data` (`sort`, `label`, `value`, `dict_type`, `status`, `creator`, `create_time`, `updater`, `update_time`) VALUES
(1, '生产班', '1', 'shift_type', 0, '1', NOW(), '1', NOW()),
(2, '检修班', '2', 'shift_type', 0, '1', NOW(), '1', NOW()),
(3, '值班', '3', 'shift_type', 0, '1', NOW(), '1', NOW());

-- 岗位类型字典
INSERT INTO `system_dict_type` (`name`, `type`, `status`, `remark`, `creator`, `create_time`, `updater`, `update_time`, `deleted`) VALUES 
('岗位类型', 'position_type', 0, '排班岗位类型', '1', NOW(), '1', NOW(), 0);

INSERT INTO `system_dict_data` (`sort`, `label`, `value`, `dict_type`, `status`, `creator`, `create_time`, `updater`, `update_time`) VALUES
(1, '调度员', '1', 'position_type', 0, '1', NOW(), '1', NOW()),
(2, '操作工', '2', 'position_type', 0, '1', NOW(), '1', NOW()),
(3, '检修工', '3', 'position_type', 0, '1', NOW(), '1', NOW()),
(4, '安全员', '4', 'position_type', 0, '1', NOW(), '1', NOW()),
(5, '质检员', '5', 'position_type', 0, '1', NOW(), '1', NOW());

-- 班制类型字典
INSERT INTO `system_dict_type` (`name`, `type`, `status`, `remark`, `creator`, `create_time`, `updater`, `update_time`, `deleted`) VALUES 
('班制类型', 'shift_system_type', 0, '班制类型', '1', NOW(), '1', NOW(), 0);

INSERT INTO `system_dict_data` (`sort`, `label`, `value`, `dict_type`, `status`, `creator`, `create_time`, `updater`, `update_time`) VALUES
(1, '三班两倒', '1', 'shift_system_type', 0, '1', NOW(), '1', NOW()),
(2, '四班三倒', '2', 'shift_system_type', 0, '1', NOW(), '1', NOW()),
(3, '两班倒', '3', 'shift_system_type', 0, '1', NOW(), '1', NOW()),
(4, '长白班', '4', 'shift_system_type', 0, '1', NOW(), '1', NOW());

-- 排班状态字典
INSERT INTO `system_dict_type` (`name`, `type`, `status`, `remark`, `creator`, `create_time`, `updater`, `update_time`, `deleted`) VALUES 
('排班状态', 'schedule_status', 0, '排班状态', '1', NOW(), '1', NOW(), 0);

INSERT INTO `system_dict_data` (`
 
 