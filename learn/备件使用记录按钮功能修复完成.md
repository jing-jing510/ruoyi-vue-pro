# 备件使用记录按钮功能修复完成

## 修复的问题

### 1. 路由导入问题
**问题**: `Cannot read properties of undefined (reading 'push')`
**原因**: 检修单列表页面缺少 `useRouter` 的导入
**修复**: 添加了 `import { useRouter } from 'vue-router'`

### 2. 路由路径问题
**问题**: 路由路径可能不正确
**修复**: 将路径从 `/coal/sparepartusagerecord` 改为 `/coal/spare-part-usage-record`

### 3. 后端查询参数缺失
**问题**: 备件使用记录页面无法接收和查询 `workOrderId` 和 `equipmentId` 参数
**修复**: 
- 前端：在 `queryParams` 中添加了 `workOrderId` 和 `equipmentId` 字段
- 前端：在 `onMounted` 中添加了URL参数处理逻辑
- 前端：在搜索表单中添加了对应的输入框
- 后端：在 `SparePartUsageRecordPageReqVO` 中添加了对应字段

### 4. 控制台日志噪音
**问题**: 控制台输出大量调试信息
**修复**: 移除了不必要的 `console.log` 语句

## 功能说明

### 备件使用记录按钮的作用
"备件使用记录"按钮的主要功能是：

1. **查看相关记录**: 跳转到备件使用记录页面，自动筛选出与当前检修单相关的备件使用记录
2. **管理备件使用**: 用户可以查看、编辑或新增该检修单相关的备件使用记录
3. **数据关联**: 通过 `workOrderId` 和 `equipmentId` 建立检修单与备件使用记录的关联关系

### 业务流程
1. 用户在检修单列表中点击"备件使用记录"按钮
2. 系统跳转到备件使用记录页面 (`/coal/spare-part-usage-record`)
3. 页面自动根据传递的 `workOrderId` 和 `equipmentId` 筛选相关记录
4. 用户可以查看、编辑或新增该检修单的备件使用记录

## 技术实现

### 前端修改
1. **检修单列表页面** (`maintenanceorder/index.vue`):
   - 添加 `useRouter` 导入
   - 修复路由路径
   - 优化控制台日志输出

2. **备件使用记录页面** (`sparepartusagerecord/index.vue`):
   - 添加 `workOrderId` 和 `equipmentId` 查询参数
   - 添加URL参数处理逻辑
   - 添加搜索表单字段
   - 添加 `useRoute` 导入

### 后端修改
1. **查询参数VO** (`SparePartUsageRecordPageReqVO.java`):
   - 添加 `workOrderId` 字段
   - 添加 `equipmentId` 字段

## 测试验证

### 测试步骤
1. 进入检修单列表页面
2. 点击任意检修单的"备件使用记录"按钮
3. 验证是否正确跳转到备件使用记录页面
4. 验证页面是否自动筛选出相关的备件使用记录
5. 验证搜索表单中的工单ID和设备ID字段是否正确显示

### 预期结果
- ✅ 按钮点击后能正确跳转到备件使用记录页面
- ✅ 页面自动显示与检修单相关的备件使用记录
- ✅ 搜索表单中显示对应的工单ID和设备ID
- ✅ 用户可以正常进行备件使用记录的增删改查操作
- ✅ 控制台不再输出调试信息

## 总结

通过这次修复，检修单列表中的"备件使用记录"按钮现在能够：
1. 正确跳转到备件使用记录页面
2. 自动传递并处理相关查询参数
3. 筛选显示与检修单相关的备件使用记录
4. 提供完整的备件使用记录管理功能

这完善了检修单与备件使用记录之间的业务关联，提升了系统的整体功能性和用户体验。
