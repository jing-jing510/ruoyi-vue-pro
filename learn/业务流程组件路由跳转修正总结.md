# 业务流程组件路由跳转修正总结

## 问题描述

在设备维护业务流程组件卡片中，点击各个节点跳转时出现404错误，原因是使用了错误的路由路径。

## 问题原因

**路由路径不匹配**: 组件中使用的跳转路径与菜单配置中的实际路径不一致。

### 错误的路径
```typescript
// 错误的跳转路径
router.push('/coal/maintenanceplan')      // 检修计划
router.push('/coal/repairrequest')        // 报修单  
router.push('/coal/maintenanceorder')     // 检修单
router.push('/coal/sparepartstock')       // 备件库存
```

### 正确的路径
根据菜单配置查询结果，正确的路径应该是：
```typescript
// 正确的跳转路径
router.push('/coal/maintenance-plan')     // 检修计划
router.push('/coal/repair-request')       // 报修单
router.push('/coal/maintenance-order')    // 检修单
router.push('/coal/spare-part-stock')     // 备件库存
```

## 修正内容

### 修正业务流程组件中的跳转路径

**修正前**:
```typescript
// 页面跳转方法
const goToMaintenancePlan = () => {
  router.push('/coal/maintenanceplan')
}

const goToRepairRequest = () => {
  router.push('/coal/repairrequest')
}

const goToMaintenanceOrder = () => {
  router.push('/coal/maintenanceorder')
}

const goToSparePartUsageRecord = () => {
  router.push('/coal/spare-part-usage-record')
}

const goToSparePartStock = () => {
  router.push('/coal/sparepartstock')
}
```

**修正后**:
```typescript
// 页面跳转方法
const goToMaintenancePlan = () => {
  router.push('/coal/maintenance-plan')
}

const goToRepairRequest = () => {
  router.push('/coal/repair-request')
}

const goToMaintenanceOrder = () => {
  router.push('/coal/maintenance-order')
}

const goToSparePartUsageRecord = () => {
  router.push('/coal/spare-part-usage-record')
}

const goToSparePartStock = () => {
  router.push('/coal/spare-part-stock')
}
```

## 芋道框架路由约定

根据芋道框架的路由跳转文档：

### 1. 路由跳转方式
```typescript
// 简单跳转
this.$router.push({ path: "/system/user" });

// 跳转页面并设置请求参数，使用 `query` 属性
this.$router.push({ path: "/system/user", query: {id: "1", name: "芋道"} });
```

### 2. 路由路径规则
- 路由路径必须与菜单管理中的 `path` 字段完全一致
- 完整路径格式：`/父级路径/子级路径`
- 在Vue 3 Composition API中使用 `router.push` 而不是 `this.$router.push`

### 3. 菜单配置对应关系
根据数据库查询结果：

| 功能模块 | 菜单路径 | 完整路由路径 |
|---------|---------|-------------|
| 检修计划管理 | maintenance-plan | /coal/maintenance-plan |
| 检修单管理 | maintenance-order | /coal/maintenance-order |
| 报修单管理 | repair-request | /coal/repair-request |
| 备件使用记录管理 | spare-part-usage-record | /coal/spare-part-usage-record |
| 备件库存记录管理 | spare-part-stock | /coal/spare-part-stock |

## 修正后的功能

### 1. 节点跳转功能
- **检修计划节点**: 点击跳转到检修计划管理页面
- **报修单节点**: 点击跳转到报修单管理页面  
- **检修单节点**: 点击跳转到检修单管理页面
- **备件使用记录节点**: 点击跳转到备件使用记录管理页面
- **库存更新节点**: 点击跳转到备件库存管理页面

### 2. 快速操作功能
- **新建计划**: 跳转到检修计划管理页面
- **新建报修**: 跳转到报修单管理页面
- **使用记录**: 跳转到备件使用记录管理页面
- **库存查看**: 跳转到备件库存管理页面

## 测试验证

修正后，业务流程组件卡片应该能够：

1. **正常显示**: 在首页正确显示业务流程卡片
2. **节点跳转**: 点击各个流程节点能正确跳转到对应页面
3. **快速操作**: 点击快速操作按钮能正确跳转
4. **数据统计**: 正确显示各模块的统计数据
5. **自动刷新**: 按设定间隔自动刷新数据

## 教训

1. **路由路径一致性**: 跳转路径必须与菜单配置中的路径完全一致
2. **菜单配置查询**: 在实现跳转功能前，必须先查询菜单配置确认正确路径
3. **芋道框架约定**: 必须严格遵循框架的路由跳转约定
4. **完整测试**: 功能实现后需要进行完整的跳转测试

## 相关文件

- `yudao-ui/yudao-ui-admin-vue3/src/components/EquipmentMaintenanceBusinessFlowCard.vue` - 业务流程组件（已修正）
- `yudao-ui/yudao-ui-admin-vue3/src/views/Home/Index.vue` - 首页集成
- 菜单配置表 `system_menu` - 路由路径配置
