# 备件管理模块设计文档

## 🔧 模块概述

基于合同要求，备件管理模块是选煤厂设备维护管理的核心组成部分，用于管理设备备件的库存、预警、使用记录等。该模块完全独立设计，不依赖ERP模块，与设备档案管理模块建立关联关系。

## 🎯 功能需求

根据合同要求，备件管理模块需要实现：

1. **建立备件与设备的关联关系** - 可以快速查询备件
2. **统计备件数据** - 实现备件数量入库出库的统计  
3. **建立备件库存预警机制** - 低于预警库存时支持消息推送
4. **设备检修时添加需要更换的零部件** - 方便零部件寿命统计分析
5. **推测零部件使用寿命** - 最终实现对零部件更换的周期性提醒
6. **出入库管理** - 记录不同备件的出入库情况，支持详细记录和冻结日期配置

## 🗄️ 数据库设计

### 表结构总览
```
备件管理模块表结构:
├── coal_spare_part_category         # 备件分类表 (树表)
├── coal_spare_part_info            # 备件基础信息表 (单表)
├── coal_spare_part_equipment       # 备件设备关联表 (主子表)
├── coal_spare_part_stock           # 备件库存记录表 (单表)
├── coal_spare_part_inventory_log   # 备件出入库记录表 (单表)
├── coal_spare_part_alert           # 备件预警记录表 (单表)
└── coal_spare_part_usage_record    # 备件使用记录表 (单表)
```

### 1. 备件分类表 (tree表) - coal_spare_part_category

```sql
DROP TABLE IF EXISTS `coal_spare_part_category`;
CREATE TABLE `coal_spare_part_category` (
    `id` BIGINT NOT NULL AUTO_INCREMENT COMMENT '分类ID',
    `parent_id` BIGINT NOT NULL DEFAULT 0 COMMENT '父分类ID (0=根分类)',
    `category_name` VARCHAR(50) NOT NULL COMMENT '分类名称',
    `category_code` VARCHAR(20) NOT NULL COMMENT '分类编码',
    `category_level` TINYINT NOT NULL DEFAULT 1 COMMENT '分类层级：1大类 2中类 3小类',
    `sort` INT NOT NULL DEFAULT 0 COMMENT '排序',
    `status` TINYINT NOT NULL DEFAULT 1 COMMENT '状态：0禁用 1启用',
    `remark` VARCHAR(500) DEFAULT NULL COMMENT '备注',
    
    -- 基础字段
    `creator` VARCHAR(64) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NULL DEFAULT '' COMMENT '创建者',
    `create_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    `updater` VARCHAR(64) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NULL DEFAULT '' COMMENT '更新者',
    `update_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    `deleted` BIT(1) NOT NULL DEFAULT b'0' COMMENT '是否删除',
    `tenant_id` BIGINT NOT NULL DEFAULT 0 COMMENT '租户编号',
    
    PRIMARY KEY (`id`) USING BTREE,
    INDEX `idx_parent_id` (`parent_id`) USING BTREE,
    INDEX `idx_category_code` (`category_code`) USING BTREE
) ENGINE = InnoDB AUTO_INCREMENT = 1 CHARACTER SET = utf8mb4 COLLATE = utf8mb4_unicode_ci COMMENT = '备件分类表 (树表)';
```

### 2. 备件基础信息表 (单表) - coal_spare_part_info

```sql
DROP TABLE IF EXISTS `coal_spare_part_info`;
CREATE TABLE `coal_spare_part_info` (
    `id` BIGINT NOT NULL AUTO_INCREMENT COMMENT '备件ID',
    `spare_part_code` VARCHAR(50) NOT NULL COMMENT '备件编号',
    `spare_part_name` VARCHAR(100) NOT NULL COMMENT '备件名称',
    `category_id` BIGINT NOT NULL COMMENT '备件分类ID',
    `specification` VARCHAR(200) DEFAULT NULL COMMENT '规格型号',
    `brand` VARCHAR(100) DEFAULT NULL COMMENT '品牌',
    `unit` VARCHAR(20) DEFAULT NULL COMMENT '计量单位',
    
    -- 备件类型和特性
    `spare_part_type` TINYINT NOT NULL COMMENT '备件类型：1易损件 2标准件 3专用件 4工具',
    `material` VARCHAR(100) DEFAULT NULL COMMENT '材质',
    `weight` DECIMAL(8,3) DEFAULT NULL COMMENT '重量(kg)',
    `dimensions` VARCHAR(100) DEFAULT NULL COMMENT '外形尺寸',
    
    -- 库存管理
    `min_stock` DECIMAL(10,2) NOT NULL DEFAULT 0 COMMENT '最低库存预警数量',
    `max_stock` DECIMAL(10,2) DEFAULT NULL COMMENT '最高库存数量',
    `safety_stock` DECIMAL(10,2) DEFAULT NULL COMMENT '安全库存数量',
    `current_stock` DECIMAL(10,2) NOT NULL DEFAULT 0 COMMENT '当前库存数量',
    
    -- 供应商和采购信息
    `supplier` VARCHAR(100) DEFAULT NULL COMMENT '主要供应商',
    `supplier_part_no` VARCHAR(50) DEFAULT NULL COMMENT '供应商零件号',
    `unit_price` DECIMAL(10,2) DEFAULT NULL COMMENT '单价',
    `lead_time` INT DEFAULT NULL COMMENT '采购周期(天)',
    
    -- 使用周期信息
    `replacement_cycle` INT DEFAULT NULL COMMENT '建议更换周期(天)',
    `average_lifespan` INT DEFAULT NULL COMMENT '平均使用寿命(天)',
    `usage_frequency` TINYINT DEFAULT 3 COMMENT '使用频率：1很低 2低 3中等 4高 5很高',
    
    -- 存储信息
    `storage_location` VARCHAR(100) DEFAULT NULL COMMENT '存储位置',
    `storage_condition` VARCHAR(200) DEFAULT NULL COMMENT '存储条件要求',
    
    -- 状态信息
    `status` TINYINT NOT NULL DEFAULT 1 COMMENT '状态：1正常 2停用 3淘汰',
    `is_critical` TINYINT(1) NOT NULL DEFAULT 0 COMMENT '是否关键备件：1是 0否',
    
    -- 图片和文档
    `image_url` VARCHAR(500) DEFAULT NULL COMMENT '备件图片URL',
    `manual_url` VARCHAR(500) DEFAULT NULL COMMENT '说明书文件URL',
    `drawing_url` VARCHAR(500) DEFAULT NULL COMMENT '图纸文件URL',
    
    `remark` TEXT DEFAULT NULL COMMENT '备注',
    
    -- 基础字段
    `creator` VARCHAR(64) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NULL DEFAULT '' COMMENT '创建者',
    `create_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    `updater` VARCHAR(64) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NULL DEFAULT '' COMMENT '更新者',
    `update_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    `deleted` BIT(1) NOT NULL DEFAULT b'0' COMMENT '是否删除',
    `tenant_id` BIGINT NOT NULL DEFAULT 0 COMMENT '租户编号',
    
    PRIMARY KEY (`id`) USING BTREE,
    UNIQUE KEY `uk_spare_part_code` (`spare_part_code`, `deleted`) USING BTREE,
    INDEX `idx_category` (`category_id`) USING BTREE,
    INDEX `idx_spare_part_type` (`spare_part_type`) USING BTREE,
    INDEX `idx_status` (`status`) USING BTREE,
    INDEX `idx_is_critical` (`is_critical`) USING BTREE
) ENGINE = InnoDB AUTO_INCREMENT = 1 CHARACTER SET = utf8mb4 COLLATE = utf8mb4_unicode_ci COMMENT = '备件基础信息表';
```

### 3. 备件设备关联表 (主子表的子表) - coal_spare_part_equipment

```sql
DROP TABLE IF EXISTS `coal_spare_part_equipment`;
CREATE TABLE `coal_spare_part_equipment` (
    `id` BIGINT NOT NULL AUTO_INCREMENT COMMENT '关联ID',
    `spare_part_id` BIGINT NOT NULL COMMENT '备件ID',
    `equipment_id` BIGINT NOT NULL COMMENT '设备ID',
    `usage_count` INT NOT NULL DEFAULT 1 COMMENT '单次使用数量',
    `install_position` VARCHAR(200) DEFAULT NULL COMMENT '安装位置',
    `is_required` TINYINT NOT NULL DEFAULT 1 COMMENT '是否必需：1必需 0非必需',
    `replacement_difficulty` TINYINT DEFAULT 3 COMMENT '更换难度：1容易 2一般 3困难 4很困难',
    `replacement_time` INT DEFAULT NULL COMMENT '更换时间(分钟)',
    `tools_required` VARCHAR(200) DEFAULT NULL COMMENT '所需工具',
    `safety_requirements` VARCHAR(500) DEFAULT NULL COMMENT '安全要求',
    `remark` VARCHAR(500) DEFAULT NULL COMMENT '备注',
    
    -- 基础字段
    `creator` VARCHAR(64) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NULL DEFAULT '' COMMENT '创建者',
    `create_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    `updater` VARCHAR(64) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NULL DEFAULT '' COMMENT '更新者',
    `update_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    `deleted` BIT(1) NOT NULL DEFAULT b'0' COMMENT '是否删除',
    `tenant_id` BIGINT NOT NULL DEFAULT 0 COMMENT '租户编号',
    
    PRIMARY KEY (`id`) USING BTREE,
    UNIQUE KEY `uk_spare_part_equipment` (`spare_part_id`, `equipment_id`, `deleted`) USING BTREE,
    INDEX `idx_spare_part` (`spare_part_id`) USING BTREE,
    INDEX `idx_equipment` (`equipment_id`) USING BTREE
) ENGINE = InnoDB AUTO_INCREMENT = 1 CHARACTER SET = utf8mb4 COLLATE = utf8mb4_unicode_ci COMMENT = '备件设备关联表';
```

### 4. 备件库存记录表 (单表) - coal_spare_part_stock

```sql
DROP TABLE IF EXISTS `coal_spare_part_stock`;
CREATE TABLE `coal_spare_part_stock` (
    `id` BIGINT NOT NULL AUTO_INCREMENT COMMENT '库存记录ID',
    `spare_part_id` BIGINT NOT NULL COMMENT '备件ID',
    `warehouse_location` VARCHAR(100) NOT NULL COMMENT '仓库位置',
    `stock_type` TINYINT NOT NULL COMMENT '库存类型：1可用库存 2锁定库存 3待检库存 4报废库存',
    `quantity` DECIMAL(10,2) NOT NULL DEFAULT 0 COMMENT '库存数量',
    `unit_cost` DECIMAL(10,2) DEFAULT NULL COMMENT '单位成本',
    `total_cost` DECIMAL(12,2) DEFAULT NULL COMMENT '总成本',
    `batch_no` VARCHAR(50) DEFAULT NULL COMMENT '批次号',
    `production_date` DATE DEFAULT NULL COMMENT '生产日期',
    `expiry_date` DATE DEFAULT NULL COMMENT '有效期至',
    `last_in_date` DATETIME DEFAULT NULL COMMENT '最后入库时间',
    `last_out_date` DATETIME DEFAULT NULL COMMENT '最后出库时间',
    `remark` VARCHAR(500) DEFAULT NULL COMMENT '备注',
    
    -- 基础字段
    `creator` VARCHAR(64) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NULL DEFAULT '' COMMENT '创建者',
    `create_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    `updater` VARCHAR(64) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NULL DEFAULT '' COMMENT '更新者',
    `update_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    `deleted` BIT(1) NOT NULL DEFAULT b'0' COMMENT '是否删除',
    `tenant_id` BIGINT NOT NULL DEFAULT 0 COMMENT '租户编号',
    
    PRIMARY KEY (`id`) USING BTREE,
    INDEX `idx_spare_part` (`spare_part_id`) USING BTREE,
    INDEX `idx_warehouse` (`warehouse_location`) USING BTREE,
    INDEX `idx_stock_type` (`stock_type`) USING BTREE
) ENGINE = InnoDB AUTO_INCREMENT = 1 CHARACTER SET = utf8mb4 COLLATE = utf8mb4_unicode_ci COMMENT = '备件库存记录表';
```

### 5. 备件出入库记录表 (单表) - coal_spare_part_inventory_log

```sql
DROP TABLE IF EXISTS `coal_spare_part_inventory_log`;
CREATE TABLE `coal_spare_part_inventory_log` (
    `id` BIGINT NOT NULL AUTO_INCREMENT COMMENT '记录ID',
    `spare_part_id` BIGINT NOT NULL COMMENT '备件ID',
    `operation_type` TINYINT NOT NULL COMMENT '操作类型：1入库 2出库 3调拨 4盘点 5报废',
    `operation_date` DATETIME NOT NULL COMMENT '操作时间',
    `quantity` DECIMAL(10,2) NOT NULL COMMENT '数量(正数入库，负数出库)',
    `unit_price` DECIMAL(10,2) DEFAULT NULL COMMENT '单价',
    `total_amount` DECIMAL(12,2) DEFAULT NULL COMMENT '总金额',
    
    -- 操作相关信息
    `operator_id` BIGINT DEFAULT NULL COMMENT '操作人ID',
    `warehouse_location` VARCHAR(100) DEFAULT NULL COMMENT '仓库位置',
    `batch_no` VARCHAR(50) DEFAULT NULL COMMENT '批次号',
    
    -- 关联信息
    `equipment_id` BIGINT DEFAULT NULL COMMENT '关联设备ID(出库时)',
    `work_order_id` BIGINT DEFAULT NULL COMMENT '关联工单ID',
    `supplier_id` BIGINT DEFAULT NULL COMMENT '供应商ID(入库时)',
    `purchase_order_no` VARCHAR(50) DEFAULT NULL COMMENT '采购单号',
    
    -- 审批信息
    `approver_id` BIGINT DEFAULT NULL COMMENT '审批人ID',
    `approve_time` DATETIME DEFAULT NULL COMMENT '审批时间',
    `approve_status` TINYINT DEFAULT 1 COMMENT '审批状态：1待审批 2已审批 3已拒绝',
    
    `operation_reason` VARCHAR(500) DEFAULT NULL COMMENT '操作原因',
    `remark` VARCHAR(500) DEFAULT NULL COMMENT '备注',
    
    -- 基础字段
    `creator` VARCHAR(64) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NULL DEFAULT '' COMMENT '创建者',
    `create_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    `updater` VARCHAR(64) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NULL DEFAULT '' COMMENT '更新者',
    `update_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    `deleted` BIT(1) NOT NULL DEFAULT b'0' COMMENT '是否删除',
    `tenant_id` BIGINT NOT NULL DEFAULT 0 COMMENT '租户编号',
    
    PRIMARY KEY (`id`) USING BTREE,
    INDEX `idx_spare_part` (`spare_part_id`) USING BTREE,
    INDEX `idx_operation_type` (`operation_type`) USING BTREE,
    INDEX `idx_operation_date` (`operation_date`) USING BTREE,
    INDEX `idx_operator` (`operator_id`) USING BTREE,
    INDEX `idx_equipment` (`equipment_id`) USING BTREE
) ENGINE = InnoDB AUTO_INCREMENT = 1 CHARACTER SET = utf8mb4 COLLATE = utf8mb4_unicode_ci COMMENT = '备件出入库记录表';
```

### 6. 备件预警记录表 (单表) - coal_spare_part_alert

```sql
DROP TABLE IF EXISTS `coal_spare_part_alert`;
CREATE TABLE `coal_spare_part_alert` (
    `id` BIGINT NOT NULL AUTO_INCREMENT COMMENT '预警ID',
    `spare_part_id` BIGINT NOT NULL COMMENT '备件ID',
    `alert_type` TINYINT NOT NULL COMMENT '预警类型：1库存不足 2库存过多 3更换提醒 4过期提醒 5停产预警',
    `alert_level` TINYINT NOT NULL DEFAULT 1 COMMENT '预警级别：1低 2中 3高 4紧急',
    `alert_status` TINYINT NOT NULL DEFAULT 1 COMMENT '预警状态：1待处理 2已处理 3已忽略 4已关闭',
    
    -- 预警内容
    `alert_title` VARCHAR(100) NOT NULL COMMENT '预警标题',
    `alert_message` VARCHAR(500) NOT NULL COMMENT '预警信息',
    `current_stock` DECIMAL(10,2) DEFAULT NULL COMMENT '当前库存',
    `threshold_value` DECIMAL(10,2) DEFAULT NULL COMMENT '阈值',
    `equipment_id` BIGINT DEFAULT NULL COMMENT '关联设备ID(更换提醒时)',
    
    -- 处理信息
    `handler_id` BIGINT DEFAULT NULL COMMENT '处理人ID',
    `handle_time` DATETIME DEFAULT NULL COMMENT '处理时间',
    `handle_action` VARCHAR(500) DEFAULT NULL COMMENT '处理措施',
    `handle_remark` VARCHAR(500) DEFAULT NULL COMMENT '处理备注',
    
    -- 提醒信息
    `is_sent` TINYINT(1) NOT NULL DEFAULT 0 COMMENT '是否已发送通知：1是 0否',
    `send_time` DATETIME DEFAULT NULL COMMENT '发送时间',
    `recipients` VARCHAR(500) DEFAULT NULL COMMENT '接收人列表(逗号分隔)',
    
    -- 基础字段
    `creator` VARCHAR(64) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NULL DEFAULT '' COMMENT '创建者',
    `create_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    `updater` VARCHAR(64) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NULL DEFAULT '' COMMENT '更新者',
    `update_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    `deleted` BIT(1) NOT NULL DEFAULT b'0' COMMENT '是否删除',
    `tenant_id` BIGINT NOT NULL DEFAULT 0 COMMENT '租户编号',
    
    PRIMARY KEY (`id`) USING BTREE,
    INDEX `idx_spare_part` (`spare_part_id`) USING BTREE,
    INDEX `idx_alert_type` (`alert_type`) USING BTREE,
    INDEX `idx_alert_status` (`alert_status`) USING BTREE,
    INDEX `idx_alert_level` (`alert_level`) USING BTREE,
    INDEX `idx_equipment` (`equipment_id`) USING BTREE
) ENGINE = InnoDB AUTO_INCREMENT = 1 CHARACTER SET = utf8mb4 COLLATE = utf8mb4_unicode_ci COMMENT = '备件预警记录表';
```

### 7. 备件使用记录表 (单表) - coal_spare_part_usage_record

```sql
DROP TABLE IF EXISTS `coal_spare_part_usage_record`;
CREATE TABLE `coal_spare_part_usage_record` (
    `id` BIGINT NOT NULL AUTO_INCREMENT COMMENT '使用记录ID',
    `spare_part_id` BIGINT NOT NULL COMMENT '备件ID',
    `equipment_id` BIGINT NOT NULL COMMENT '设备ID',
    `usage_type` TINYINT NOT NULL COMMENT '使用类型：1计划更换 2故障更换 3预防性更换 4临时更换',
    `usage_date` DATETIME NOT NULL COMMENT '使用日期',
    `quantity` DECIMAL(10,2) NOT NULL COMMENT '使用数量',
    
    -- 人员信息
    `operator_id` BIGINT DEFAULT NULL COMMENT '操作人ID',
    `supervisor_id` BIGINT DEFAULT NULL COMMENT '监督人ID',
    `work_team` VARCHAR(100) DEFAULT NULL COMMENT '作业班组',
    
    -- 关联信息
    `work_order_id` BIGINT DEFAULT NULL COMMENT '工单ID(关联检修单)',
    `fault_id` BIGINT DEFAULT NULL COMMENT '故障ID(关联故障记录)',
    `maintenance_plan_id` BIGINT DEFAULT NULL COMMENT '维护计划ID',
    
    -- 更换详情
    `old_part_condition` TINYINT DEFAULT NULL COMMENT '旧件状态：1正常 2磨损 3损坏 4报废',
    `failure_mode` VARCHAR(200) DEFAULT NULL COMMENT '失效模式',
    `usage_duration` INT DEFAULT NULL COMMENT '使用时长(天)',
    `replacement_reason` VARCHAR(500) DEFAULT NULL COMMENT '更换原因',
    
    -- 预测信息
    `predicted_lifespan` INT DEFAULT NULL COMMENT '预计寿命(天)',
    `next_replacement_date` DATE DEFAULT NULL COMMENT '预计下次更换日期',
    `performance_rating` TINYINT DEFAULT NULL COMMENT '性能评级：1优秀 2良好 3一般 4较差 5很差',
    
    -- 成本信息
    `unit_cost` DECIMAL(10,2) DEFAULT NULL COMMENT '单位成本',
    `total_cost` DECIMAL(12,2) DEFAULT NULL COMMENT '总成本',
    `labor_cost` DECIMAL(10,2) DEFAULT NULL COMMENT '人工成本',
    `downtime_cost` DECIMAL(10,2) DEFAULT NULL COMMENT '停机成本',
    
    `remark` VARCHAR(500) DEFAULT NULL COMMENT '备注',
    
    -- 基础字段
    `creator` VARCHAR(64) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NULL DEFAULT '' COMMENT '创建者',
    `create_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    `updater` VARCHAR(64) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NULL DEFAULT '' COMMENT '更新者',
    `update_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',
    `deleted` BIT(1) NOT NULL DEFAULT b'0' COMMENT '是否删除',
    `tenant_id` BIGINT NOT NULL DEFAULT 0 COMMENT '租户编号',
    
    PRIMARY KEY (`id`) USING BTREE,
    INDEX `idx_spare_part` (`spare_part_id`) USING BTREE,
    INDEX `idx_equipment` (`equipment_id`) USING BTREE,
    INDEX `idx_usage_date` (`usage_date`) USING BTREE,
    INDEX `idx_usage_type` (`usage_type`) USING BTREE,
    INDEX `idx_operator` (`operator_id`) USING BTREE
) ENGINE = InnoDB AUTO_INCREMENT = 1 CHARACTER SET = utf8mb4 COLLATE = utf8mb4_unicode_ci COMMENT = '备件使用记录表';
```

## 📊 字典数据配置

### 字典类型配置
```sql
-- 备件类型字典
INSERT INTO `system_dict_type` (`name`, `type`, `status`, `remark`, `creator`, `create_time`, `updater`, `update_time`, `deleted`) VALUES 
('备件类型', 'spare_part_type', 0, '备件分类类型', '1', NOW(), '1', NOW(), 0);

-- 使用频率字典
INSERT INTO `system_dict_type` (`name`, `type`, `status`, `remark`, `creator`, `create_time`, `updater`, `update_time`, `deleted`) VALUES 
('使用频率', 'usage_frequency', 0, '备件使用频率', '1', NOW(), '1', NOW(), 0);

-- 备件状态字典
INSERT INTO `system_dict_type` (`name`, `type`, `status`, `remark`, `creator`, `create_time`, `updater`, `update_time`, `deleted`) VALUES 
('备件状态', 'spare_part_status', 0, '备件状态', '1', NOW(), '1', NOW(), 0);

-- 库存类型字典
INSERT INTO `system_dict_type` (`name`, `type`, `status`, `remark`, `creator`, `create_time`, `updater`, `update_time`, `deleted`) VALUES 
('库存类型', 'stock_type', 0, '库存类型', '1', NOW(), '1', NOW(), 0);

-- 操作类型字典
INSERT INTO `system_dict_type` (`name`, `type`, `status`, `remark`, `creator`, `create_time`, `updater`, `update_time`, `deleted`) VALUES 
('操作类型', 'operation_type', 0, '出入库操作类型', '1', NOW(), '1', NOW(), 0);

-- 预警类型字典
INSERT INTO `system_dict_type` (`name`, `type`, `status`, `remark`, `creator`, `create_time`, `updater`, `update_time`, `deleted`) VALUES 
('预警类型', 'alert_type', 0, '备件预警类型', '1', NOW(), '1', NOW(), 0);

-- 预警级别字典
INSERT INTO `system_dict_type` (`name`, `type`, `status`, `remark`, `creator`, `create_time`, `updater`, `update_time`, `deleted`) VALUES 
('预警级别', 'alert_level', 0, '预警级别', '1', NOW(), '1', NOW(), 0);

-- 预警状态字典
INSERT INTO `system_dict_type` (`name`, `type`, `status`, `remark`, `creator`, `create_time`, `updater`, `update_time`, `deleted`) VALUES 
('预警状态', 'alert_status', 0, '预警处理状态', '1', NOW(), '1', NOW(), 0);

-- 使用类型字典
INSERT INTO `system_dict_type` (`name`, `type`, `status`, `remark`, `creator`, `create_time`, `updater`, `update_time`, `deleted`) VALUES 
('使用类型', 'usage_type', 0, '备件使用类型', '1', NOW(), '1', NOW(), 0);

-- 更换难度字典
INSERT INTO `system_dict_type` (`name`, `type`, `status`, `remark`, `creator`, `create_time`, `updater`, `update_time`, `deleted`) VALUES 
('更换难度', 'replacement_difficulty', 0, '备件更换难度', '1', NOW(), '1', NOW(), 0);

-- 旧件状态字典
INSERT INTO `system_dict_type` (`name`, `type`, `status`, `remark`, `creator`, `create_time`, `updater`, `update_time`, `deleted`) VALUES 
('旧件状态', 'old_part_condition', 0, '旧备件状态', '1', NOW(), '1', NOW(), 0);

-- 性能评级字典
INSERT INTO `system_dict_type` (`name`, `type`, `status`, `remark`, `creator`, `create_time`, `updater`, `update_time`, `deleted`) VALUES 
('性能评级', 'performance_rating', 0, '备件性能评级', '1', NOW(), '1', NOW(), 0);

-- 审批状态字典
INSERT INTO `system_dict_type` (`name`, `type`, `status`, `remark`, `creator`, `create_time`, `updater`, `update_time`, `deleted`) VALUES 
('审批状态', 'approve_status', 0, '审批状态', '1', NOW(), '1', NOW(), 0);
```

### 字典数据配置
```sql
-- 备件类型字典数据
INSERT INTO `system_dict_data` (`sort`, `label`, `value`, `dict_type`, `status`, `color_type`, `creator`, `create_time`, `updater`, `update_time`) VALUES
(1, '易损件', '1', 'spare_part_type', 0, 'warning', '1', NOW(), '1', NOW()),
(2, '标准件', '2', 'spare_part_type', 0, 'primary', '1', NOW(), '1', NOW()),
(3, '专用件', '3', 'spare_part_type', 0, 'success', '1', NOW(), '1', NOW()),
(4, '工具', '4', 'spare_part_type', 0, 'info', '1', NOW(), '1', NOW());

-- 使用频率字典数据
INSERT INTO `system_dict_data` (`sort`, `label`, `value`, `dict_type`, `status`, `creator`, `create_time`, `updater`, `update_time`) VALUES
(1, '很低', '1', 'usage_frequency', 0, '1', NOW(), '1', NOW()),
(2, '低', '2', 'usage_frequency', 0, '1', NOW(), '1', NOW()),
(3, '中等', '3', 'usage_frequency', 0, '1', NOW(), '1', NOW()),
(4, '高', '4', 'usage_frequency', 0, '1', NOW(), '1', NOW()),
(5, '很高', '5', 'usage_frequency', 0, '1', NOW(), '1', NOW());

-- 备件状态字典数据
INSERT INTO `system_dict_data` (`sort`, `label`, `value`, `dict_type`, `status`, `color_type`, `creator`, `create_time`, `updater`, `update_time`) VALUES
(1, '正常', '1', 'spare_part_status', 0, 'success', '1', NOW(), '1', NOW()),
(2, '停用', '2', 'spare_part_status', 0, 'warning', '1', NOW(), '1', NOW()),
(3, '淘汰', '3', 'spare_part_status', 0, 'danger', '1', NOW(), '1', NOW());

-- 库存类型字典数据
INSERT INTO `system_dict_data` (`sort`, `label`, `value`, `dict_type`, `status`, `color_type`, `creator`, `create_time`, `updater`, `update_time`) VALUES
(1, '可用库存', '1', 'stock_type', 0, 'success', '1', NOW(), '1', NOW()),
(2, '锁定库存', '2', 'stock_type', 0, 'warning', '1', NOW(), '1', NOW()),
(3, '待检库存', '3', 'stock_type', 0, 'info', '1', NOW(), '1', NOW()),
(4, '报废库存', '4', 'stock_type', 0, 'danger', '1', NOW(), '1', NOW());

-- 操作类型字典数据
INSERT INTO `system_dict_data` (`sort`, `label`, `value`, `dict_type`, `status`, `color_type`, `creator`, `create_time`, `updater`, `update_time`) VALUES
(1, '入库', '1', 'operation_type', 0, 'success', '1', NOW(), '1', NOW()),
(2, '出库', '2', 'operation_type', 0, 'primary', '1', NOW(), '1', NOW()),
(3, '调拨', '3', 'operation_type', 0, 'info', '1', NOW(), '1', NOW()),
(4, '盘点', '4', 'operation_type', 0, 'warning', '1', NOW(), '1', NOW()),
(5, '报废', '5', 'operation_type', 0, 'danger', '1', NOW(), '1', NOW());

-- 预警类型字典数据
INSERT INTO `system_dict_data` (`sort`, `label`, `value`, `dict_type`, `status`, `color_type`, `creator`, `create_time`, `updater`, `update_time`) VALUES
(1, '库存不足', '1', 'alert_type', 0, 'danger', '1', NOW(), '1', NOW()),
(2, '库存过多', '2', 'alert_type', 0, 'warning', '1', NOW(), '1', NOW()),
(3, '更换提醒', '3', 'alert_type', 0, 'primary', '1', NOW(), '1', NOW()),
(4, '过期提醒', '4', 'alert_type', 0, 'info', '1', NOW(), '1', NOW()),
(5, '停产预警', '5', 'alert_type', 0, 'danger', '1', NOW(), '1', NOW());

-- 预警级别字典数据
INSERT INTO `system_dict_data` (`sort`, `label`, `value`, `dict_type`, `status`, `color_type`, `creator`, `create_time`, `updater`, `update_time`) VALUES
(1, '低', '1', 'alert_level', 0, 'info', '1', NOW(), '1', NOW()),
(2, '中', '2', 'alert_level', 0, 'warning', '1', NOW(), '1', NOW()),
(3, '高', '3', 'alert_level', 0, 'danger', '1', NOW(), '1', NOW()),
(4, '紧急', '4', 'alert_level', 0, 'danger', '1', NOW(), '1', NOW());

-- 预警状态字典数据
INSERT INTO `system_dict_data` (`sort`, `label`, `value`, `dict_type`, `status`, `color_type`, `creator`, `create_time`, `updater`, `update_time`) VALUES
(1, '待处理', '1', 'alert_status', 0, 'warning', '1', NOW(), '1', NOW()),
(2, '已处理', '2', 'alert_status', 0, 'success', '1', NOW(), '1', NOW()),
(3, '已忽略', '3', 'alert_status', 0, 'info', '1', NOW(), '1', NOW()),
(4, '已关闭', '4', 'alert_status', 0, 'default', '1', NOW(), '1', NOW());

-- 使用类型字典数据
INSERT INTO `system_dict_data` (`sort`, `label`, `value`, `dict_type`, `status`, `color_type`, `creator`, `create_time`, `updater`, `update_time`) VALUES
(1, '计划更换', '1', 'usage_type', 0, 'success', '1', NOW(), '1', NOW()),
(2, '故障更换', '2', 'usage_type', 0, 'danger', '1', NOW(), '1', NOW()),
(3, '预防性更换', '3', 'usage_type', 0, 'primary', '1', NOW(), '1', NOW()),
(4, '临时更换', '4', 'usage_type', 0, 'warning', '1', NOW(), '1', NOW());

-- 更换难度字典数据
INSERT INTO `system_dict_data` (`sort`, `label`, `value`, `dict_type`, `status`, `color_type`, `creator`, `create_time`, `updater`, `update_time`) VALUES
(1, '容易', '1', 'replacement_difficulty', 0, 'success', '1', NOW(), '1', NOW()),
(2, '一般', '2', 'replacement_difficulty', 0, 'primary', '1', NOW(), '1', NOW()),
(3, '困难', '3', 'replacement_difficulty', 0, 'warning', '1', NOW(), '1', NOW()),
(4, '很困难', '4', 'replacement_difficulty', 0, 'danger', '1', NOW(), '1', NOW());

-- 旧件状态字典数据
INSERT INTO `system_dict_data` (`sort`, `label`, `value`, `dict_type`, `status`, `color_type`, `creator`, `create_time`, `updater`, `update_time`) VALUES
(1, '正常', '1', 'old_part_condition', 0, 'success', '1', NOW(), '1', NOW()),
(2, '磨损', '2', 'old_part_condition', 0, 'warning', '1', NOW(), '1', NOW()),
(3, '损坏', '3', 'old_part_condition', 0, 'danger', '1', NOW(), '1', NOW()),
(4, '报废', '4', 'old_part_condition', 0, 'danger', '1', NOW(), '1', NOW());

-- 性能评级字典数据
INSERT INTO `system_dict_data` (`sort`, `label`, `value`, `dict_type`, `status`, `color_type`, `creator`, `create_time`, `updater`, `update_time`) VALUES
(1, '优秀', '1', 'performance_rating', 0, 'success', '1', NOW(), '1', NOW()),
(2, '良好', '2', 'performance_rating', 0, 'primary', '1', NOW(), '1', NOW()),
(3, '一般', '3', 'performance_rating', 0, 'info', '1', NOW(), '1', NOW()),
(4, '较差', '4', 'performance_rating', 0, 'warning', '1', NOW(), '1', NOW()),
(5, '很差', '5', 'performance_rating', 0, 'danger', '1', NOW(), '1', NOW());

-- 审批状态字典数据
INSERT INTO `system_dict_data` (`sort`, `label`, `value`, `dict_type`, `status`, `color_type`, `creator`, `create_time`, `updater`, `update_time`) VALUES
(1, '待审批', '1', 'approve_status', 0, 'warning', '1', NOW(), '1', NOW()),
(2, '已审批', '2', 'approve_status', 0, 'success', '1', NOW(), '1', NOW()),
(3, '已拒绝', '3', 'approve_status', 0, 'danger', '1', NOW(), '1', NOW());
```

## 🌱 初始化数据

### 备件分类初始化数据
```sql
-- 备件分类初始化数据
-- 1. 主要分类
INSERT INTO coal_spare_part_category (parent_id, category_name, category_code, category_level, sort, status, remark, creator, create_time, updater, update_time, deleted, tenant_id) VALUES
(0, '机械备件', 'MECHANICAL', 1, 1, 1, '机械类备件', 'system', NOW(), 'system', NOW(), 0, 1),
(0, '电气备件', 'ELECTRICAL', 1, 2, 1, '电气类备件', 'system', NOW(), 'system', NOW(), 0, 1),
(0, '液压备件', 'HYDRAULIC', 1, 3, 1, '液压类备件', 'system', NOW(), 'system', NOW(), 0, 1),
(0, '气动备件', 'PNEUMATIC', 1, 4, 1, '气动类备件', 'system', NOW(), 'system', NOW(), 0, 1),
(0, '传动备件', 'TRANSMISSION', 1, 5, 1, '传动类备件', 'system', NOW(), 'system', NOW(), 0, 1),
(0, '密封备件', 'SEALING', 1, 6, 1, '密封类备件', 'system', NOW(), 'system', NOW(), 0, 1),
(0, '润滑备件', 'LUBRICATION', 1, 7, 1, '润滑类备件', 'system', NOW(), 'system', NOW(), 0, 1),
(0, '工具仪表', 'TOOLS', 1, 8, 1, '工具仪表类', 'system', NOW(), 'system', NOW(), 0, 1);

-- 获取分类ID并插入子分类
SET @mechanical_id = (SELECT id FROM coal_spare_part_category WHERE category_code = 'MECHANICAL' LIMIT 1);
SET @electrical_id = (SELECT id FROM coal_spare_part_category WHERE category_code = 'ELECTRICAL' LIMIT 1);
SET @hydraulic_id = (SELECT id FROM coal_spare_part_category WHERE category_code = 'HYDRAULIC' LIMIT 1);
SET @transmission_id = (SELECT id FROM coal_spare_part_category WHERE category_code = 'TRANSMISSION' LIMIT 1);

-- 机械备件子分类
INSERT INTO coal_spare_part_category (parent_id, category_name, category_code, category_level, sort, status, remark, creator, create_time, updater, update_time, deleted, tenant_id) VALUES
(@mechanical_id, '轴承类', 'BEARING', 2, 1, 1, '各种轴承', 'system', NOW(), 'system', NOW(), 0, 1),
(@mechanical_id, '齿轮类', 'GEAR', 2, 2, 1, '齿轮及齿轮箱备件', 'system', NOW(), 'system', NOW(), 0, 1),
(@mechanical_id, '联轴器', 'COUPLING', 2, 3, 1, '联轴器及配件', 'system', NOW(), 'system', NOW(), 0, 1),
(@mechanical_id, '螺栓螺母', 'FASTENER', 2, 4, 1, '标准紧固件', 'system', NOW(), 'system', NOW(), 0, 1),
(@mechanical_id, '弹簧类', 'SPRING', 2, 5, 1, '各种弹簧', 'system', NOW(), 'system', NOW(), 0, 1);

-- 电气备件子分类
INSERT INTO coal_spare_part_category (parent_id, category_name, category_code, category_level, sort, status, remark, creator, create_time, updater, update_time, deleted, tenant_id) VALUES
(@electrical_id, '电机备件', 'MOTOR', 2, 1, 1, '电机及配件', 'system', NOW(), 'system', NOW(), 0, 1),
(@electrical_id, '开关类', 'SWITCH', 2, 2, 1, '各种开关', 'system', NOW(), 'system', NOW(), 0, 1),
(@electrical_id, '接触器', 'CONTACTOR', 2, 3, 1, '接触器及配件', 'system', NOW(), 'system', NOW(), 0, 1),
(@electrical_id, '保险丝', 'FUSE', 2, 4, 1, '保险丝及熔断器', 'system', NOW(), 'system', NOW(), 0, 1),
(@electrical_id, '电缆线', 'CABLE', 2, 5, 1, '各种电缆线', 'system', NOW(), 'system', NOW(), 0, 1);

-- 液压备件子分类
INSERT INTO coal_spare_part_category (parent_id, category_name, category_code, category_level, sort, status, remark, creator, create_time, updater, update_time, deleted, tenant_id) VALUES
(@hydraulic_id, '液压油', 'HYDRAULIC_OIL', 2, 1, 1, '液压油', 'system', NOW(), 'system', NOW(), 0, 1),
(@hydraulic_id, '液压阀', 'HYDRAULIC_VALVE', 2, 2, 1, '各种液压阀', 'system', NOW(), 'system', NOW(), 0, 1),
(@hydraulic_id, '油缸', 'CYLINDER', 2, 3, 1, '液压油缸及配件', 'system', NOW(), 'system', NOW(), 0, 1),
(@hydraulic_id, '油泵', 'PUMP', 2, 4, 1, '液压泵及配件', 'system', NOW(), 'system', NOW(), 0, 1),
(@hydraulic_id, '过滤器', 'FILTER', 2, 5, 1, '液压过滤器', 'system', NOW(), 'system', NOW(), 0, 1);

-- 传动备件子分类
INSERT INTO coal_spare_part_category (parent_id, category_name, category_code, category_level, sort, status, remark, creator, create_time, updater, update_time, deleted, tenant_id) VALUES
(@transmission_id, '皮带类', 'BELT', 2, 1, 1, '各种传动皮带', 'system', NOW(), 'system', NOW(), 0, 1),
(@transmission_id, '链条类', 'CHAIN', 2, 2, 1, '各种传动链条', 'system', NOW(), 'system', NOW(), 0, 1),
(@transmission_id, '皮带轮', 'PULLEY', 2, 3, 1, '皮带轮及配件', 'system', NOW(), 'system', NOW(), 0, 1),
(@transmission_id, '减速机', 'REDUCER', 2, 4, 1, '减速机及配件', 'system', NOW(), 'system', NOW(), 0, 1);
```

### 备件基础信息示例数据
```sql
-- 备件基础信息示例数据
-- 获取分类ID
SET @bearing_id = (SELECT id FROM coal_spare_part_category WHERE category_code = 'BEARING' LIMIT 1);
SET @motor_id = (SELECT id FROM coal_spare_part_category WHERE category_code = 'MOTOR' LIMIT 1);
SET @belt_id = (SELECT id FROM coal_spare_part_category WHERE category_code = 'BELT' LIMIT 1);
SET @hydraulic_oil_id = (SELECT id FROM coal_spare_part_category WHERE category_code = 'HYDRAULIC_OIL' LIMIT 1);

-- 常用备件示例
INSERT INTO coal_spare_part_info (spare_part_code, spare_part_name, category_id, specification, brand, unit, spare_part_type, min_stock, max_stock, safety_stock, current_stock, supplier, unit_price, replacement_cycle, average_lifespan, usage_frequency, storage_location, is_critical, status, creator, create_time, updater, update_time, deleted, tenant_id) VALUES
('BJ001', '深沟球轴承6208', @bearing_id, '6208-2RS', 'SKF', '个', 1, 5, 20, 8, 10, 'SKF轴承公司', 85.00, 180, 150, 4, 'A01-001', 1, 1, 'system', NOW(), 'system', NOW(), 0, 1),
('BJ002', '深沟球轴承6210', @bearing_id, '6210-2RS', 'SKF', '个', 1, 3, 15, 5, 8, 'SKF轴承公司', 120.00, 180, 150, 3, 'A01-002', 1, 1, 'system', NOW(), 'system', NOW(), 0, 1),
('BJ003', '圆锥滚子轴承30210', @bearing_id, '30210', 'FAG', '个', 1, 2, 10, 3, 5, 'FAG轴承公司', 280.00, 365, 300, 2, 'A01-003', 1, 1, 'system', NOW(), 'system', NOW(), 0, 1),

('DJ001', '三相异步电机Y132M-4', @motor_id, 'Y132M-4', '西门子', '台', 3, 1, 3, 1, 2, '西门子电机', 3500.00, 1800, 1500, 2, 'B01-001', 1, 1, 'system', NOW(), 'system', NOW(), 0, 1),
('DJ002', '变频电机YVF160L-4', @motor_id, 'YVF160L-4', 'ABB', '台', 3, 1, 2, 1, 1, 'ABB电机', 5200.00, 2100, 1800, 1, 'B01-002', 1, 1, 'system', NOW(), 'system', NOW(), 0, 1),

('PD001', 'V型带B1800', @belt_id, 'B1800', '三星', '条', 1, 3, 10, 5, 6, '三星皮带', 45.00, 90, 75, 5, 'C01-001', 0, 1, 'system', NOW(), 'system', NOW(), 0, 1),
('PD002', 'V型带B2500', @belt_id, 'B2500', '三星', '条', 1, 2, 8, 3, 4, '三星皮带', 65.00, 90, 75, 4, 'C01-002', 0, 1, 'system', NOW(), 'system', NOW(), 0, 1),

('YY001', '抗磨液压油L-HM46', @hydraulic_oil_id, 'L-HM46', '长城', '升', 1, 200, 1000, 300, 500, '长城润滑油', 12.50, 360, 360, 3, 'D01-001', 0, 1, 'system', NOW(), 'system', NOW(), 0, 1);
```

### 备件库存初始化数据
```sql
-- 备件库存初始化数据
INSERT INTO coal_spare_part_stock (spare_part_id, warehouse_location, stock_type, quantity, unit_cost, total_cost, batch_no, production_date, last_in_date, creator, create_time, updater, update_time, deleted, tenant_id) VALUES
(1, 'A01-001', 1, 10, 85.00, 850.00, 'BJ001-20240101', '2024-01-01', '2024-01-15 09:00:00', 'system', NOW(), 'system', NOW(), 0, 1),
(2, 'A01-002', 1, 8, 120.00, 960.00, 'BJ002-20240101', '2024-01-01', '2024-01-15 09:30:00', 'system', NOW(), 'system', NOW(), 0, 1),
(3, 'A01-003', 1, 5, 280.00, 1400.00, 'BJ003-20240101', '2024-01-01', '2024-01-15 10:00:00', 'system', NOW(), 'system', NOW(), 0, 1),
(4, 'B01-001', 1, 2, 3500.00, 7000.00, 'DJ001-20240101', '2024-01-01', '2024-01-20 14:00:00', 'system', NOW(), 'system', NOW(), 0, 1),
(5, 'B01-002', 1, 1, 5200.00, 5200.00, 'DJ002-20240101', '2024-01-01', '2024-01-20 14:30:00', 'system', NOW(), 'system', NOW(), 0, 1),
(6, 'C01-001', 1, 6, 45.00, 270.00, 'PD001-20240101', '2024-01-01', '2024-01-18 11:00:00', 'system', NOW(), 'system', NOW(), 0, 1),
(7, 'C01-002', 1, 4, 65.00, 260.00, 'PD002-20240101', '2024-01-01', '2024-01-18 11:30:00', 'system', NOW(), 'system', NOW(), 0, 1),
(8, 'D01-001', 1, 500, 12.50, 6250.00, 'YY001-20240101', '2024-01-01', '2024-01-22 16:00:00', 'system', NOW(), 'system', NOW(), 0, 1);
```

## 🛠️ 代码生成器配置

### 生成顺序和策略

#### 第一阶段：基础数据管理
1. **备件分类管理** (树表)
   - 表名：coal_spare_part_category
   - 生成模式：树表
   - 树编码字段：id
   - 树父编码字段：parent_id  
   - 树名称字段：category_name

2. **备件基础信息** (单表)
   - 表名：coal_spare_part_info
   - 生成模式：单表(CRUD)
   - 关联备件分类表

#### 第二阶段：关联关系管理
3. **备件设备关联** (主子表)
   - 主表：coal_spare_part_info
   - 子表：coal_spare_part_equipment
   - 关联字段：spare_part_id

#### 第三阶段：业务功能模块
4. **库存管理** (单表)
   - 表名：coal_spare_part_stock
   - 生成模式：单表(CRUD)

5. **出入库记录** (单表)
   - 表名：coal_spare_part_inventory_log
   - 生成模式：单表(CRUD)

6. **预警管理** (单表)
   - 表名：coal_spare_part_alert
   - 生成模式：单表(CRUD)

7. **使用记录** (单表)
   - 表名：coal_spare_part_usage_record
   - 生成模式：单表(CRUD)

### 代码生成器详细配置

#### 1. 备件分类表配置
```yaml
基本信息:
  - 表名: coal_spare_part_category
  - 类名: SparePartCategory  
  - 功能名: 备件分类管理
  - 作者: 芋道源码
  - 包路径: cn.iocoder.yudao.module.coal.sparepart

生成信息:
  - 生成模板: 树表
  - 树编码字段: id
  - 树父编码字段: parent_id
  - 树名称字段: category_name
```

#### 2. 备件基础信息表配置
```yaml
基本信息:
  - 表名: coal_spare_part_info
  - 类名: SparePartInfo
  - 功能名: 备件基础信息管理
  - 作者: 芋道源码
  - 包路径: cn.iocoder.yudao.module.coal.sparepart

生成信息:
  - 生成模板: 单表(CRUD)
  - 主键字段: id
  - 业务名称: 备件信息
```

#### 3. 备件设备关联表配置
```yaml
基本信息:
  - 表名: coal_spare_part_equipment
  - 类名: SparePartEquipment
  - 功能名: 备件设备关联管理
  - 作者: 芋道源码
  - 包路径: cn.iocoder.yudao.module.coal.sparepart

生成信息:
  - 生成模板: 主子表
  - 主表: coal_spare_part_info
  - 子表: coal_spare_part_equipment
  - 主键字段: id
  - 外键字段: spare_part_id
```

#### 4. 其他单表配置
每个单表都按照类似的配置方式，使用单表(CRUD)模板生成基础代码。

## 🎯 开发实施步骤

### 步骤1：准备工作
1. **执行SQL脚本**
   - 创建所有数据库表
   - 导入字典配置数据
   - 导入初始化测试数据

2. **验证数据**
   - 检查表结构是否正确
   - 验证外键关联关系
   - 确认字典数据完整性

### 步骤2：基础代码生成
1. **生成备件分类管理** (树表)
2. **生成备件基础信息** (单表)
3. **生成备件设备关联** (主子表)
4. **生成其他业务表** (单表)

### 步骤3：功能完善
1. **完善前端页面**
   - 优化用户界面
   - 添加业务校验
   - 实现数据关联

2. **完善后端服务**
   - 业务逻辑实现
   - 预警机制开发
   - 统计分析功能

### 步骤4：集成测试
1. **模块内测试**
   - 功能完整性测试
   - 数据一致性测试

2. **模块间集成**
   - 与设备档案模块集成
   - 与检修管理模块预留接口

## ⚠️ 开发注意事项

### 数据一致性
1. **库存数据同步** - 出入库操作后及时更新库存表
2. **预警状态维护** - 库存变化后重新计算预警状态
3. **使用记录关联** - 确保使用记录与出库记录的一致性

### 业务逻辑
1. **备件编号唯一性** - 系统内备件编号不能重复
2. **库存不能为负** - 出库时检查库存是否充足
3. **预警阈值合理性** - 最低库存应小于安全库存

### 性能考虑
1. **大数据量处理** - 使用记录表可能数据量较大，注意分页和索引
2. **定时任务优化** - 预警检查任务的执行频率和性能
3. **报表查询优化** - 统计分析查询的SQL优化

### 扩展性
1. **模块化设计** - 便于后续功能扩展
2. **接口标准化** - 为第三方系统集成预留接口
3. **配置化管理** - 预警规则、审批流程等支持配置

## 📊 预期功能特性

### 核心功能
- ✅ 备件分类层级管理
- ✅ 备件基础信息维护
- ✅ 备件与设备关联管理
- ✅ 库存实时监控
- ✅ 出入库流程管理
- ✅ 自动预警机制
- ✅ 使用记录追踪
- ✅ 寿命分析预测

### 高级功能
- 📈 库存统计分析
- 📊 成本核算分析
- 🔔 消息推送提醒
- 📱 移动端支持（预留）
- 🔗 第三方系统集成（预留）

---

*备件管理模块设计文档* | *完全独立于ERP模块* | *与设备档案管理紧密集成*
